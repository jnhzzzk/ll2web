<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>长期高损原因分析指标体系</title>
    <style>
        body {
            font-family: 'PingFang SC', 'Microsoft YaHei', sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f5f7fa;
            color: #333;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        header {
            background-color: #1890ff;
            color: white;
            padding: 20px;
            text-align: center;
            border-radius: 5px;
            margin-bottom: 30px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        h1 {
            margin: 0;
            font-size: 28px;
        }
        .card {
            background-color: white;
            border-radius: 5px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
            overflow: hidden;
        }
        .card-header {
            background-color: #e6f7ff;
            padding: 15px 20px;
            border-bottom: 1px solid #e8e8e8;
            font-weight: bold;
            font-size: 18px;
            color: #1890ff;
        }
        .card-body {
            padding: 20px;
        }
        .indicator-group {
            margin-bottom: 30px;
        }
        .indicator {
            border-left: 4px solid #1890ff;
            padding: 10px 15px;
            margin-bottom: 15px;
            background-color: #f0f8ff;
            border-radius: 0 4px 4px 0;
        }
        .indicator.total {
            border-left-color: #722ed1;
            background-color: #f9f0ff;
        }
        .indicator.sub {
            border-left-color: #13c2c2;
            background-color: #e6fffb;
        }
        .indicator-name {
            font-weight: bold;
            margin-bottom: 5px;
        }
        .indicator-desc {
            color: #666;
            font-size: 14px;
            margin-bottom: 5px;
        }
        .indicator-formula {
            font-family: 'Courier New', monospace;
            background-color: #f5f5f5;
            padding: 8px;
            border-radius: 4px;
            font-size: 14px;
            margin-top: 10px;
        }
        .visualization {
            margin-top: 15px;
            border: 1px solid #e8e8e8;
            border-radius: 4px;
            padding: 15px;
            background-color: white;
        }
        .viz-title {
            font-weight: bold;
            margin-bottom: 10px;
            color: #1890ff;
            font-size: 14px;
        }
        .chart {
            width: 100%;
            height: 200px;
            position: relative;
        }
        .chart-legend {
            display: flex;
            justify-content: center;
            margin-top: 10px;
            font-size: 12px;
        }
        .legend-item {
            display: flex;
            align-items: center;
            margin: 0 10px;
        }
        .legend-color {
            width: 12px;
            height: 12px;
            border-radius: 2px;
            margin-right: 5px;
        }
        .axis-label {
            font-size: 12px;
            color: #666;
        }
        .relationships {
            border: 1px solid #e8e8e8;
            border-radius: 5px;
            padding: 20px;
            margin-top: 20px;
        }
        .diagram {
            width: 100%;
            height: 500px;
            margin: 30px 0;
            border: 1px solid #e8e8e8;
            border-radius: 5px;
            background-color: white;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        svg {
            width: 100%;
            height: 100%;
        }
        .node rect {
            stroke: #999;
            fill: #fff;
            stroke-width: 1.5px;
        }
        .edgePath path {
            stroke: #333;
            stroke-width: 1.5px;
        }
        footer {
            text-align: center;
            margin-top: 30px;
            padding: 20px;
            color: #666;
            font-size: 14px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }
        th {
            background-color: #f5f7fa;
            font-weight: bold;
        }
        tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        tr:hover {
            background-color: #f0f8ff;
        }
        .bar-chart .bar {
            fill: #1890ff;
            transition: fill 0.3s;
        }
        .bar-chart .bar:hover {
            fill: #69c0ff;
        }
        .bar-chart .bar-label {
            font-size: 12px;
            text-anchor: middle;
        }
        .line-chart .line {
            fill: none;
            stroke: #1890ff;
            stroke-width: 2;
        }
        .line-chart .point {
            fill: #1890ff;
        }
        .line-chart .line.threshold {
            stroke: #f5222d;
            stroke-dasharray: 5,5;
        }
        .line-chart .area {
            fill: rgba(24, 144, 255, 0.1);
        }
        .line-chart .area.above-threshold {
            fill: rgba(245, 34, 45, 0.1);
        }
        .scatter-chart .point {
            fill: #1890ff;
            transition: r 0.3s;
        }
        .scatter-chart .point:hover {
            r: 6;
        }
        .scatter-chart .correlation-line {
            stroke: #722ed1;
            stroke-width: 2;
            stroke-dasharray: 5,5;
        }
        .heatmap-chart .cell {
            stroke: white;
            stroke-width: 1;
        }
        .heatmap-chart .cell-label {
            font-size: 10px;
            text-anchor: middle;
            dominant-baseline: middle;
            fill: white;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>长期高损原因分析指标体系</h1>
        </header>

        <div class="card">
            <div class="card-header">长期高损概述</div>
            <div class="card-body">
                <p>长期高损是指台区线损率长期高于合理阈值的现象，通常指连续30天以上线损率超过阈值（如10%）。长期高损会导致电网资产使用效率低下、供电成本增加以及潜在的安全隐患。</p>
                <p>本指标体系通过设计一系列与长期高损密切相关的诊断指标，为快速定位和解决长期高损问题提供数据支持。</p>
            </div>
        </div>

        <div class="card">
            <div class="card-header">长期高损可能原因及指标体系</div>
            <div class="card-body">
                <div class="indicator-group">
                    <h3>基础判定指标</h3>
                    <div class="indicator">
                        <div class="indicator-name">台区高损持续天数 (TQ_HIGH_LOSS_DAYS)</div>
                        <div class="indicator-desc">台区线损率连续高于阈值的天数，超过30天即判定为长期高损</div>
                        <div class="indicator-formula">COUNT(DISTINCT STATIS_DATE) WHERE LOSS_RATIO > LOSS_RATIO_THRESHOLD</div>
                        <div class="visualization">
                            <div class="viz-title">某台区连续高损天数统计示例</div>
                            <div class="chart">
                                <svg width="100%" height="100%" viewBox="0 0 800 200">
                                    <!-- X轴 -->
                                    <line x1="50" y1="150" x2="750" y2="150" stroke="#ccc" stroke-width="1"></line>
                                    <!-- Y轴 -->
                                    <line x1="50" y1="20" x2="50" y2="150" stroke="#ccc" stroke-width="1"></line>
                                    
                                    <!-- X轴刻度 -->
                                    <text x="100" y="170" text-anchor="middle" class="axis-label">1日</text>
                                    <text x="200" y="170" text-anchor="middle" class="axis-label">10日</text>
                                    <text x="300" y="170" text-anchor="middle" class="axis-label">20日</text>
                                    <text x="400" y="170" text-anchor="middle" class="axis-label">30日</text>
                                    <text x="500" y="170" text-anchor="middle" class="axis-label">40日</text>
                                    <text x="600" y="170" text-anchor="middle" class="axis-label">50日</text>
                                    <text x="700" y="170" text-anchor="middle" class="axis-label">60日</text>
                                    
                                    <!-- Y轴刻度 -->
                                    <text x="40" y="150" text-anchor="end" class="axis-label">0%</text>
                                    <text x="40" y="115" text-anchor="end" class="axis-label">5%</text>
                                    <text x="40" y="80" text-anchor="end" class="axis-label">10%</text>
                                    <text x="40" y="45" text-anchor="end" class="axis-label">15%</text>
                                    
                                    <!-- 阈值线 -->
                                    <line x1="50" y1="80" x2="750" y2="80" stroke="#f5222d" stroke-width="1.5" stroke-dasharray="5,5"></line>
                                    <text x="750" y="75" text-anchor="end" fill="#f5222d" font-size="12">线损率阈值(10%)</text>
                                    
                                    <!-- 持续时间标记 -->
                                    <line x1="400" y1="20" x2="400" y2="150" stroke="#722ed1" stroke-width="1.5" stroke-dasharray="5,5"></line>
                                    <text x="410" y="35" fill="#722ed1" font-size="12">长期高损判定(30天)</text>
                                    
                                    <!-- 线损率曲线 -->
                                    <path d="M50,120 Q100,130 150,110 T250,120 T350,60 T450,50 T550,70 T650,40 T750,55" fill="none" stroke="#1890ff" stroke-width="2"></path>
                                    
                                    <!-- 高损区域标记 -->
                                    <path d="M320,80 L320,60 L450,50 L550,70 L650,40 L750,55 L750,80 Z" fill="rgba(245, 34, 45, 0.1)"></path>
                                    
                                    <!-- 当前持续高损天数标记 -->
                                    <circle cx="550" cy="70" r="5" fill="#f5222d"></circle>
                                    <text x="560" y="60" fill="#f5222d" font-size="14" font-weight="bold">当前已持续45天</text>
                                </svg>
                            </div>
                            <div class="chart-legend">
                                <div class="legend-item">
                                    <div class="legend-color" style="background-color: #1890ff;"></div>
                                    <span>线损率曲线</span>
                                </div>
                                <div class="legend-item">
                                    <div class="legend-color" style="background-color: #f5222d;"></div>
                                    <span>高损区域(>10%)</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="indicator-group">
                    <h3>原因一：CT倍率互感器异常</h3>
                    <div class="indicator total">
                        <div class="indicator-name">CT倍率异常指标(总表) (GM_CT_ABNORMAL_RATIO)</div>
                        <div class="indicator-desc">总表CT倍率异常评分，评估CT倍率变更前后供电量/用电量比值变化</div>
                        <div class="indicator-formula">AVG(NEW_RATE/OLD_RATE) WHERE CT_PT_TYPE = 'CT' AND IsGM = 1</div>
                        <div class="visualization">
                            <div class="viz-title">总表CT倍率变更前后供用电比值变化示例</div>
                            <div class="chart">
                                <svg width="100%" height="100%" viewBox="0 0 800 200" class="bar-chart">
                                    <!-- X轴 -->
                                    <line x1="50" y1="150" x2="750" y2="150" stroke="#ccc" stroke-width="1"></line>
                                    <!-- Y轴 -->
                                    <line x1="50" y1="20" x2="50" y2="150" stroke="#ccc" stroke-width="1"></line>
                                    
                                    <!-- X轴刻度 -->
                                    <text x="150" y="170" text-anchor="middle" class="axis-label">变更前3月</text>
                                    <text x="250" y="170" text-anchor="middle" class="axis-label">变更前2月</text>
                                    <text x="350" y="170" text-anchor="middle" class="axis-label">变更前1月</text>
                                    <line x1="400" y1="20" x2="400" y2="170" stroke="#722ed1" stroke-width="2" stroke-dasharray="5,5"></line>
                                    <text x="400" y="185" text-anchor="middle" class="axis-label" fill="#722ed1" font-weight="bold">CT倍率变更</text>
                                    <text x="450" y="170" text-anchor="middle" class="axis-label">变更后1月</text>
                                    <text x="550" y="170" text-anchor="middle" class="axis-label">变更后2月</text>
                                    <text x="650" y="170" text-anchor="middle" class="axis-label">变更后3月</text>
                                    
                                    <!-- Y轴刻度 -->
                                    <text x="40" y="150" text-anchor="end" class="axis-label">0%</text>
                                    <text x="40" y="115" text-anchor="end" class="axis-label">5%</text>
                                    <text x="40" y="80" text-anchor="end" class="axis-label">10%</text>
                                    <text x="40" y="45" text-anchor="end" class="axis-label">15%</text>
                                    
                                    <!-- 变更前供用电比值柱形图 -->
                                    <rect class="bar" x="120" y="85" width="60" height="65" fill="#722ed1"></rect>
                                    <rect class="bar" x="220" y="90" width="60" height="60" fill="#722ed1"></rect>
                                    <rect class="bar" x="320" y="80" width="60" height="70" fill="#722ed1"></rect>
                                    
                                    <!-- 变更后供用电比值柱形图（异常） -->
                                    <rect class="bar" x="420" y="45" width="60" height="105" fill="#f5222d"></rect>
                                    <rect class="bar" x="520" y="50" width="60" height="100" fill="#f5222d"></rect>
                                    <rect class="bar" x="620" y="40" width="60" height="110" fill="#f5222d"></rect>
                                    
                                    <!-- 柱形图标签 -->
                                    <text x="150" y="80" text-anchor="middle" class="bar-label">9.2%</text>
                                    <text x="250" y="85" text-anchor="middle" class="bar-label">8.7%</text>
                                    <text x="350" y="75" text-anchor="middle" class="bar-label">9.5%</text>
                                    <text x="450" y="40" text-anchor="middle" class="bar-label" fill="#f5222d" font-weight="bold">14.3%</text>
                                    <text x="550" y="45" text-anchor="middle" class="bar-label" fill="#f5222d" font-weight="bold">13.8%</text>
                                    <text x="650" y="35" text-anchor="middle" class="bar-label" fill="#f5222d" font-weight="bold">15.1%</text>
                                    
                                    <!-- 变化率标注 -->
                                    <text x="550" y="30" text-anchor="middle" fill="#f5222d" font-weight="bold" font-size="14">变更后供用电比值上升约48%</text>
                                </svg>
                            </div>
                            <div class="chart-legend">
                                <div class="legend-item">
                                    <div class="legend-color" style="background-color: #722ed1;"></div>
                                    <span>变更前供用电比值</span>
                                </div>
                                <div class="legend-item">
                                    <div class="legend-color" style="background-color: #f5222d;"></div>
                                    <span>变更后供用电比值(异常)</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="indicator sub">
                        <div class="indicator-name">CT倍率异常指标(分表) (SM_CT_ABNORMAL_RATIO)</div>
                        <div class="indicator-desc">分表CT倍率异常评分，评估CT倍率变更前后用电量变化</div>
                        <div class="indicator-formula">AVG(NEW_RATE/OLD_RATE) WHERE CT_PT_TYPE = 'CT' AND IsGM = 0</div>
                        <div class="visualization">
                            <div class="viz-title">分表CT倍率变更前后用电量变化示例</div>
                            <div class="chart">
                                <svg width="100%" height="100%" viewBox="0 0 800 200" class="line-chart">
                                    <!-- X轴 -->
                                    <line x1="50" y1="150" x2="750" y2="150" stroke="#ccc" stroke-width="1"></line>
                                    <!-- Y轴 -->
                                    <line x1="50" y1="20" x2="50" y2="150" stroke="#ccc" stroke-width="1"></line>
                                    
                                    <!-- X轴刻度 -->
                                    <text x="100" y="170" text-anchor="middle" class="axis-label">1月</text>
                                    <text x="200" y="170" text-anchor="middle" class="axis-label">2月</text>
                                    <text x="300" y="170" text-anchor="middle" class="axis-label">3月</text>
                                    <line x1="400" y1="20" x2="400" y2="170" stroke="#13c2c2" stroke-width="2" stroke-dasharray="5,5"></line>
                                    <text x="400" y="185" text-anchor="middle" class="axis-label" fill="#13c2c2" font-weight="bold">CT倍率变更</text>
                                    <text x="500" y="170" text-anchor="middle" class="axis-label">4月</text>
                                    <text x="600" y="170" text-anchor="middle" class="axis-label">5月</text>
                                    <text x="700" y="170" text-anchor="middle" class="axis-label">6月</text>
                                    
                                    <!-- Y轴刻度 -->
                                    <text x="40" y="150" text-anchor="end" class="axis-label">0</text>
                                    <text x="40" y="120" text-anchor="end" class="axis-label">100</text>
                                    <text x="40" y="90" text-anchor="end" class="axis-label">200</text>
                                    <text x="40" y="60" text-anchor="end" class="axis-label">300</text>
                                    <text x="40" y="30" text-anchor="end" class="axis-label">400</text>
                                    
                                    <!-- 正常趋势线 -->
                                    <path d="M50,120 L100,115 L200,125 L300,110 L400,115" class="line" stroke="#13c2c2"></path>
                                    <circle cx="100" cy="115" r="4" class="point" fill="#13c2c2"></circle>
                                    <circle cx="200" cy="125" r="4" class="point" fill="#13c2c2"></circle>
                                    <circle cx="300" cy="110" r="4" class="point" fill="#13c2c2"></circle>
                                    <circle cx="400" cy="115" r="4" class="point" fill="#13c2c2"></circle>
                                    
                                    <!-- 异常趋势线 -->
                                    <path d="M400,115 L500,60 L600,65 L700,55" class="line" stroke="#f5222d"></path>
                                    <circle cx="500" cy="60" r="4" class="point" fill="#f5222d"></circle>
                                    <circle cx="600" cy="65" r="4" class="point" fill="#f5222d"></circle>
                                    <circle cx="700" cy="55" r="4" class="point" fill="#f5222d"></circle>
                                    
                                    <!-- 异常标注 -->
                                    <text x="600" y="40" text-anchor="middle" fill="#f5222d" font-weight="bold" font-size="14">CT倍率变更后用电量异常增加约100%</text>
                                </svg>
                            </div>
                            <div class="chart-legend">
                                <div class="legend-item">
                                    <div class="legend-color" style="background-color: #13c2c2;"></div>
                                    <span>变更前用电量趋势</span>
                                </div>
                                <div class="legend-item">
                                    <div class="legend-color" style="background-color: #f5222d;"></div>
                                    <span>变更后用电量趋势(异常)</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="indicator-group">
                    <h3>原因二：台区户表关系错误</h3>
                    <div class="indicator total">
                        <div class="indicator-name">台区户表关系错误指标(总表) (GM_METER_RELATION_ERROR)</div>
                        <div class="indicator-desc">总表关联户表错误程度，通过分析线损率方差评估</div>
                        <div class="indicator-formula">STD(CONSUMED/SUPPLIED) WHERE REGION_ID AND IsGM = 1</div>
                        <div class="visualization">
                            <div class="viz-title">台区线损率波动对比示例</div>
                            <div class="chart">
                                <svg width="100%" height="100%" viewBox="0 0 800 200" class="line-chart">
                                    <!-- X轴 -->
                                    <line x1="50" y1="150" x2="750" y2="150" stroke="#ccc" stroke-width="1"></line>
                                    <!-- Y轴 -->
                                    <line x1="50" y1="20" x2="50" y2="150" stroke="#ccc" stroke-width="1"></line>
                                    
                                    <!-- X轴刻度 - 30天 -->
                                    <text x="100" y="170" text-anchor="middle" class="axis-label">5</text>
                                    <text x="200" y="170" text-anchor="middle" class="axis-label">10</text>
                                    <text x="300" y="170" text-anchor="middle" class="axis-label">15</text>
                                    <text x="400" y="170" text-anchor="middle" class="axis-label">20</text>
                                    <text x="500" y="170" text-anchor="middle" class="axis-label">25</text>
                                    <text x="600" y="170" text-anchor="middle" class="axis-label">30</text>
                                    <text x="700" y="170" text-anchor="middle" class="axis-label">35</text>
                                    <text x="400" y="190" text-anchor="middle" font-weight="bold">日期</text>
                                    
                                    <!-- Y轴刻度 - 线损率 -->
                                    <text x="40" y="150" text-anchor="end" class="axis-label">0%</text>
                                    <text x="40" y="120" text-anchor="end" class="axis-label">5%</text>
                                    <text x="40" y="90" text-anchor="end" class="axis-label">10%</text>
                                    <text x="40" y="60" text-anchor="end" class="axis-label">15%</text>
                                    <text x="40" y="30" text-anchor="end" class="axis-label">20%</text>
                                    
                                    <!-- 阈值线 -->
                                    <line x1="50" y1="90" x2="750" y2="90" stroke="#fa8c16" stroke-width="1.5" stroke-dasharray="5,5"></line>
                                    <text x="750" y="85" text-anchor="end" fill="#fa8c16" font-size="12">线损率阈值(10%)</text>
                                    
                                    <!-- 正常台区线损率曲线 -->
                                    <path d="M50,120 L100,115 L150,118 L200,113 L250,116 L300,110 L350,115 L400,112 L450,117 L500,114 L550,116 L600,112 L650,115 L700,110 L750,114" class="line" stroke="#722ed1"></path>
                                    
                                    <!-- 户表关系错误台区线损率曲线 -->
                                    <path d="M50,80 L100,40 L150,110 L200,70 L250,120 L300,50 L350,130 L400,60 L450,140 L500,30 L550,100 L600,20 L650,90 L700,40 L750,110" class="line" stroke="#f5222d"></path>
                                    
                                    <text x="400" y="25" text-anchor="middle" fill="#f5222d" font-weight="bold" font-size="14">户表关系错误台区线损率方差: 19.6%</text>
                                    <text x="400" y="100" text-anchor="middle" fill="#722ed1" font-weight="bold" font-size="14">正常台区线损率方差: 3.2%</text>
                                </svg>
                            </div>
                            <div class="chart-legend">
                                <div class="legend-item">
                                    <div class="legend-color" style="background-color: #722ed1;"></div>
                                    <span>正常台区线损率曲线</span>
                                </div>
                                <div class="legend-item">
                                    <div class="legend-color" style="background-color: #f5222d;"></div>
                                    <span>户表关系错误台区线损率曲线</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="indicator sub">
                        <div class="indicator-name">台区户表关系错误指标(分表) (SM_METER_RELATION_ERROR)</div>
                        <div class="indicator-desc">分表关联台区错误程度，通过计算用电量相关性评估</div>
                        <div class="indicator-formula">CORR(Usage) WHERE AreaId AND IsGM = 0</div>
                        <div class="visualization">
                            <div class="viz-title">分表与台区总表用电量相关性散点图</div>
                            <div class="chart">
                                <svg width="100%" height="100%" viewBox="0 0 800 200" class="scatter-chart">
                                    <!-- X轴 - 总表用电量 -->
                                    <line x1="50" y1="150" x2="750" y2="150" stroke="#ccc" stroke-width="1"></line>
                                    <!-- Y轴 - 分表用电量 -->
                                    <line x1="50" y1="20" x2="50" y2="150" stroke="#ccc" stroke-width="1"></line>
                                    
                                    <!-- X轴刻度 -->
                                    <text x="400" y="170" text-anchor="middle" font-weight="bold">总表用电量</text>
                                    
                                    <!-- Y轴刻度 -->
                                    <text x="30" y="85" text-anchor="middle" transform="rotate(-90, 30, 85)" font-weight="bold">分表用电量</text>
                                    
                                    <!-- 正常关联散点图 -->
                                    <circle cx="100" cy="130" r="4" class="point" fill="#13c2c2"></circle>
                                    <circle cx="150" cy="120" r="4" class="point" fill="#13c2c2"></circle>
                                    <circle cx="200" cy="110" r="4" class="point" fill="#13c2c2"></circle>
                                    <circle cx="250" cy="100" r="4" class="point" fill="#13c2c2"></circle>
                                    <circle cx="300" cy="90" r="4" class="point" fill="#13c2c2"></circle>
                                    <circle cx="350" cy="80" r="4" class="point" fill="#13c2c2"></circle>
                                    <circle cx="370" cy="75" r="4" class="point" fill="#13c2c2"></circle>
                                    
                                    <!-- 正常关联趋势线 -->
                                    <line x1="80" y1="135" x2="380" y2="70" class="correlation-line" stroke="#13c2c2"></line>
                                    <text x="180" y="50" text-anchor="middle" fill="#13c2c2" font-weight="bold" font-size="14">正常关联相关性: 0.93</text>
                                    
                                    <!-- 异常关联散点图 -->
                                    <circle cx="450" cy="40" r="4" class="point" fill="#f5222d"></circle>
                                    <circle cx="500" cy="120" r="4" class="point" fill="#f5222d"></circle>
                                    <circle cx="550" cy="60" r="4" class="point" fill="#f5222d"></circle>
                                    <circle cx="600" cy="130" r="4" class="point" fill="#f5222d"></circle>
                                    <circle cx="650" cy="50" r="4" class="point" fill="#f5222d"></circle>
                                    <circle cx="700" cy="140" r="4" class="point" fill="#f5222d"></circle>
                                    <circle cx="720" cy="70" r="4" class="point" fill="#f5222d"></circle>
                                    
                                    <!-- 异常关联趋势线 -->
                                    <line x1="450" y1="90" x2="720" y2="90" class="correlation-line" stroke="#f5222d"></line>
                                    <text x="580" y="50" text-anchor="middle" fill="#f5222d" font-weight="bold" font-size="14">异常关联相关性: 0.12</text>
                                </svg>
                            </div>
                            <div class="chart-legend">
                                <div class="legend-item">
                                    <div class="legend-color" style="background-color: #13c2c2;"></div>
                                    <span>正常关联分表</span>
                                </div>
                                <div class="legend-item">
                                    <div class="legend-color" style="background-color: #f5222d;"></div>
                                    <span>异常关联分表</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="indicator-group">
                    <h3>原因三：窃电行为</h3>
                    <div class="indicator total">
                        <div class="indicator-name">窃电行为识别指标(总表) (GM_THEFT_DETECTION)</div>
                        <div class="indicator-desc">总表窃电行为检测指标，通过实际线损率与理论线损率差值评估</div>
                        <div class="indicator-formula">MOVING_AVG(LOSS_RATIO, 30) - TECH_LOSS_RATIO WHERE IsGM = 1</div>
                        <div class="visualization">
                            <div class="viz-title">实际线损率与理论线损率差值示例</div>
                            <div class="chart">
                                <svg width="100%" height="100%" viewBox="0 0 800 200" class="line-chart">
                                    <!-- X轴 -->
                                    <line x1="50" y1="150" x2="750" y2="150" stroke="#ccc" stroke-width="1"></line>
                                    <!-- Y轴 -->
                                    <line x1="50" y1="20" x2="50" y2="150" stroke="#ccc" stroke-width="1"></line>
                                    
                                    <!-- X轴刻度 - 90天 -->
                                    <text x="120" y="170" text-anchor="middle" class="axis-label">15天</text>
                                    <text x="260" y="170" text-anchor="middle" class="axis-label">30天</text>
                                    <text x="400" y="170" text-anchor="middle" class="axis-label">45天</text>
                                    <text x="540" y="170" text-anchor="middle" class="axis-label">60天</text>
                                    <text x="680" y="170" text-anchor="middle" class="axis-label">75天</text>
                                    <text x="400" y="190" text-anchor="middle" font-weight="bold">日期</text>
                                    
                                    <!-- Y轴刻度 - 线损率差值 -->
                                    <text x="40" y="150" text-anchor="end" class="axis-label">0%</text>
                                    <text x="40" y="120" text-anchor="end" class="axis-label">2%</text>
                                    <text x="40" y="90" text-anchor="end" class="axis-label">4%</text>
                                    <text x="40" y="60" text-anchor="end" class="axis-label">6%</text>
                                    <text x="40" y="30" text-anchor="end" class="axis-label">8%</text>
                                    
                                    <!-- 阈值线 -->
                                    <line x1="50" y1="90" x2="750" y2="90" stroke="#fa8c16" stroke-width="1.5" stroke-dasharray="5,5"></line>
                                    <text x="750" y="85" text-anchor="end" fill="#fa8c16" font-size="12">差值阈值(5%)</text>
                                    
                                    <!-- 正常区域 -->
                                    <path d="M50,140 L100,135 L150,138 L200,142 L250,130 L300,135 L350,145" class="line" stroke="#722ed1"></path>
                                    
                                    <!-- 窃电开始点 -->
                                    <line x1="350" y1="20" x2="350" y2="150" stroke="#f5222d" stroke-width="1.5" stroke-dasharray="5,5"></line>
                                    <text x="350" y="15" text-anchor="middle" fill="#f5222d" font-size="12">窃电开始</text>
                                    
                                    <!-- 窃电期间区域 -->
                                    <path d="M350,145 L400,120 L450,95 L500,75 L550,50 L600,35 L650,40 L700,30 L750,35" class="line" stroke="#f5222d"></path>
                                    
                                    <!-- 阴影区域 -->
                                    <path d="M350,145 L400,120 L450,95 L500,75 L550,50 L600,35 L650,40 L700,30 L750,35 L750,150 L350,150 Z" fill="rgba(245, 34, 45, 0.1)"></path>
                                    
                                    <text x="550" y="25" text-anchor="middle" fill="#f5222d" font-weight="bold" font-size="14">窃电期间线损率差值持续超过阈值</text>
                                </svg>
                            </div>
                            <div class="chart-legend">
                                <div class="legend-item">
                                    <div class="legend-color" style="background-color: #722ed1;"></div>
                                    <span>正常期间线损率差值</span>
                                </div>
                                <div class="legend-item">
                                    <div class="legend-color" style="background-color: #f5222d;"></div>
                                    <span>窃电期间线损率差值</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="indicator sub">
                        <div class="indicator-name">窃电行为识别指标(分表) (SM_THEFT_DETECTION)</div>
                        <div class="indicator-desc">分表窃电行为检测指标，通过统计窃电相关事件评估</div>
                        <div class="indicator-formula">COUNT(Event-269 OR Event-287 OR Event-289 OR Event-297) WHERE IsGM = 0</div>
                        <div class="visualization">
                            <div class="viz-title">窃电相关事件统计示例</div>
                            <div class="chart">
                                <svg width="100%" height="100%" viewBox="0 0 800 200" class="bar-chart">
                                    <!-- X轴 -->
                                    <line x1="50" y1="150" x2="750" y2="150" stroke="#ccc" stroke-width="1"></line>
                                    <!-- Y轴 -->
                                    <line x1="50" y1="20" x2="50" y2="150" stroke="#ccc" stroke-width="1"></line>
                                    
                                    <!-- X轴标签 -->
                                    <text x="140" y="170" text-anchor="middle" class="axis-label">CT短接/旁路</text>
                                    <text x="280" y="170" text-anchor="middle" class="axis-label">表盖打开</text>
                                    <text x="420" y="170" text-anchor="middle" class="axis-label">端子盖打开</text>
                                    <text x="560" y="170" text-anchor="middle" class="axis-label">强磁场干扰</text>
                                    <text x="700" y="170" text-anchor="middle" class="axis-label">相序反接</text>
                                    
                                    <!-- Y轴标签 - 事件次数 -->
                                    <text x="40" y="150" text-anchor="end" class="axis-label">0</text>
                                    <text x="40" y="120" text-anchor="end" class="axis-label">2</text>
                                    <text x="40" y="90" text-anchor="end" class="axis-label">4</text>
                                    <text x="40" y="60" text-anchor="end" class="axis-label">6</text>
                                    <text x="40" y="30" text-anchor="end" class="axis-label">8</text>
                                    
                                    <!-- 事件阈值线 -->
                                    <line x1="50" y1="90" x2="750" y2="90" stroke="#fa8c16" stroke-width="1.5" stroke-dasharray="5,5"></line>
                                    <text x="750" y="85" text-anchor="end" fill="#fa8c16" font-size="12">事件阈值(>3次)</text>
                                    
                                    <!-- 正常表事件柱形图 -->
                                    <rect x="90" y="140" width="30" height="10" fill="#13c2c2"></rect>
                                    <rect x="230" y="130" width="30" height="20" fill="#13c2c2"></rect>
                                    <rect x="370" y="140" width="30" height="10" fill="#13c2c2"></rect>
                                    <rect x="510" y="140" width="30" height="10" fill="#13c2c2"></rect>
                                    <rect x="650" y="140" width="30" height="10" fill="#13c2c2"></rect>
                                    
                                    <!-- 窃电表事件柱形图 -->
                                    <rect x="130" y="30" width="30" height="120" fill="#f5222d"></rect>
                                    <rect x="270" y="60" width="30" height="90" fill="#f5222d"></rect>
                                    <rect x="410" y="50" width="30" height="100" fill="#f5222d"></rect>
                                    <rect x="550" y="80" width="30" height="70" fill="#f5222d"></rect>
                                    <rect x="690" y="140" width="30" height="10" fill="#f5222d"></rect>
                                    
                                    <!-- 事件次数标签 -->
                                    <text x="105" y="135" text-anchor="middle" class="bar-label" font-size="10">1</text>
                                    <text x="245" y="125" text-anchor="middle" class="bar-label" font-size="10">2</text>
                                    <text x="385" y="135" text-anchor="middle" class="bar-label" font-size="10">1</text>
                                    <text x="525" y="135" text-anchor="middle" class="bar-label" font-size="10">1</text>
                                    <text x="665" y="135" text-anchor="middle" class="bar-label" font-size="10">1</text>
                                    
                                    <text x="145" y="25" text-anchor="middle" class="bar-label" fill="#f5222d" font-size="10" font-weight="bold">7</text>
                                    <text x="285" y="55" text-anchor="middle" class="bar-label" fill="#f5222d" font-size="10" font-weight="bold">5</text>
                                    <text x="425" y="45" text-anchor="middle" class="bar-label" fill="#f5222d" font-size="10" font-weight="bold">6</text>
                                    <text x="565" y="75" text-anchor="middle" class="bar-label" fill="#f5222d" font-size="10" font-weight="bold">4</text>
                                    <text x="705" y="135" text-anchor="middle" class="bar-label" fill="#f5222d" font-size="10">1</text>
                                    
                                    <text x="400" y="40" text-anchor="middle" fill="#f5222d" font-weight="bold" font-size="14">多种窃电相关事件频繁发生</text>
                                </svg>
                            </div>
                            <div class="chart-legend">
                                <div class="legend-item">
                                    <div class="legend-color" style="background-color: #13c2c2;"></div>
                                    <span>正常用户事件次数</span>
                                </div>
                                <div class="legend-item">
                                    <div class="legend-color" style="background-color: #f5222d;"></div>
                                    <span>疑似窃电用户事件次数</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="indicator-group">
                    <h3>原因四：时钟同步偏差</h3>
                    <div class="indicator total">
                        <div class="indicator-name">时钟同步偏差指标(总表) (GM_CLOCK_SYNC_DEVIATION)</div>
                        <div class="indicator-desc">总表时钟同步偏差指标，通过统计时钟同步相关事件评估</div>
                        <div class="indicator-formula">COUNT(Event-1538 OR Event-12803) WHERE IsGM = 1</div>
                        <div class="visualization">
                            <div class="viz-title">总表时钟同步事件统计示例</div>
                            <div class="chart">
                                <svg width="100%" height="100%" viewBox="0 0 800 200" class="bar-chart">
                                    <!-- X轴 -->
                                    <line x1="50" y1="150" x2="750" y2="150" stroke="#ccc" stroke-width="1"></line>
                                    <!-- Y轴 -->
                                    <line x1="50" y1="20" x2="50" y2="150" stroke="#ccc" stroke-width="1"></line>
                                    
                                    <!-- X轴标签 - 30天 -->
                                    <text x="120" y="170" text-anchor="middle" class="axis-label">5天</text>
                                    <text x="200" y="170" text-anchor="middle" class="axis-label">10天</text>
                                    <text x="280" y="170" text-anchor="middle" class="axis-label">15天</text>
                                    <text x="360" y="170" text-anchor="middle" class="axis-label">20天</text>
                                    <text x="440" y="170" text-anchor="middle" class="axis-label">25天</text>
                                    <text x="520" y="170" text-anchor="middle" class="axis-label">30天</text>
                                    <text x="600" y="170" text-anchor="middle" class="axis-label">35天</text>
                                    <text x="680" y="170" text-anchor="middle" class="axis-label">40天</text>
                                    
                                    <!-- Y轴标签 - 事件次数 -->
                                    <text x="40" y="150" text-anchor="end" class="axis-label">0</text>
                                    <text x="40" y="120" text-anchor="end" class="axis-label">2</text>
                                    <text x="40" y="90" text-anchor="end" class="axis-label">4</text>
                                    <text x="40" y="60" text-anchor="end" class="axis-label">6</text>
                                    <text x="40" y="30" text-anchor="end" class="axis-label">8</text>
                                    
                                    <!-- 事件阈值线 -->
                                    <line x1="50" y1="90" x2="750" y2="90" stroke="#fa8c16" stroke-width="1.5" stroke-dasharray="5,5"></line>
                                    <text x="750" y="85" text-anchor="end" fill="#fa8c16" font-size="12">时钟同步事件阈值(>3)</text>
                                    
                                    <!-- 背景矩形-交替显示 -->
                                    <rect x="50" y="20" width="80" height="130" fill="#f9f9f9"></rect>
                                    <rect x="210" y="20" width="80" height="130" fill="#f9f9f9"></rect>
                                    <rect x="370" y="20" width="80" height="130" fill="#f9f9f9"></rect>
                                    <rect x="530" y="20" width="80" height="130" fill="#f9f9f9"></rect>
                                    <rect x="690" y="20" width="60" height="130" fill="#f9f9f9"></rect>
                                    
                                    <!-- 正常总表时钟事件 -->
                                    <line x1="75" y1="150" x2="75" y2="140" stroke="#722ed1" stroke-width="2"></line>
                                    <line x1="100" y1="150" x2="100" y2="140" stroke="#722ed1" stroke-width="2"></line>
                                    <line x1="235" y1="150" x2="235" y2="140" stroke="#722ed1" stroke-width="2"></line>
                                    <line x1="385" y1="150" x2="385" y2="140" stroke="#722ed1" stroke-width="2"></line>
                                    <line x1="415" y1="150" x2="415" y2="130" stroke="#722ed1" stroke-width="2"></line>
                                    <line x1="570" y1="150" x2="570" y2="140" stroke="#722ed1" stroke-width="2"></line>
                                    <line x1="600" y1="150" x2="600" y2="140" stroke="#722ed1" stroke-width="2"></line>
                                    <line x1="715" y1="150" x2="715" y2="140" stroke="#722ed1" stroke-width="2"></line>
                                    
                                    <!-- 异常总表时钟事件 -->
                                    <line x1="150" y1="150" x2="150" y2="80" stroke="#f5222d" stroke-width="2"></line>
                                    <line x1="165" y1="150" x2="165" y2="70" stroke="#f5222d" stroke-width="2"></line>
                                    <line x1="175" y1="150" x2="175" y2="100" stroke="#f5222d" stroke-width="2"></line>
                                    <line x1="180" y1="150" x2="180" y2="60" stroke="#f5222d" stroke-width="2"></line>
                                    <line x1="185" y1="150" x2="185" y2="90" stroke="#f5222d" stroke-width="2"></line>
                                    <line x1="190" y1="150" x2="190" y2="50" stroke="#f5222d" stroke-width="2"></line>
                                    <line x1="195" y1="150" x2="195" y2="70" stroke="#f5222d" stroke-width="2"></line>
                                    
                                    <line x1="315" y1="150" x2="315" y2="100" stroke="#f5222d" stroke-width="2"></line>
                                    <line x1="320" y1="150" x2="320" y2="80" stroke="#f5222d" stroke-width="2"></line>
                                    <line x1="325" y1="150" x2="325" y2="90" stroke="#f5222d" stroke-width="2"></line>
                                    <line x1="330" y1="150" x2="330" y2="70" stroke="#f5222d" stroke-width="2"></line>
                                    
                                    <line x1="475" y1="150" x2="475" y2="70" stroke="#f5222d" stroke-width="2"></line>
                                    <line x1="485" y1="150" x2="485" y2="60" stroke="#f5222d" stroke-width="2"></line>
                                    <line x1="495" y1="150" x2="495" y2="80" stroke="#f5222d" stroke-width="2"></line>
                                    <line x1="505" y1="150" x2="505" y2="90" stroke="#f5222d" stroke-width="2"></line>
                                    
                                    <line x1="645" y1="150" x2="645" y2="100" stroke="#f5222d" stroke-width="2"></line>
                                    <line x1="655" y1="150" x2="655" y2="70" stroke="#f5222d" stroke-width="2"></line>
                                    <line x1="665" y1="150" x2="665" y2="90" stroke="#f5222d" stroke-width="2"></line>
                                    
                                    <!-- 标注 -->
                                    <text x="175" y="40" text-anchor="middle" fill="#f5222d" font-weight="bold" font-size="12">时钟同步频繁异常</text>
                                    <text x="400" y="40" text-anchor="middle" fill="#f5222d" font-weight="bold" font-size="14">时钟同步事件多次超阈值</text>
                                </svg>
                            </div>
                            <div class="chart-legend">
                                <div class="legend-item">
                                    <div class="legend-color" style="background-color: #722ed1;"></div>
                                    <span>正常时钟同步事件</span>
                                </div>
                                <div class="legend-item">
                                    <div class="legend-color" style="background-color: #f5222d;"></div>
                                    <span>异常时钟同步事件</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="indicator sub">
                        <div class="indicator-name">时钟同步偏差指标(分表) (SM_CLOCK_SYNC_DEVIATION)</div>
                        <div class="indicator-desc">分表时钟同步偏差指标，通过统计时钟同步相关事件评估</div>
                        <div class="indicator-formula">COUNT(Event-1538 OR Event-12803) WHERE IsGM = 0</div>
                        <div class="visualization">
                            <div class="viz-title">分表时钟同步偏差热力图示例</div>
                            <div class="chart">
                                <svg width="100%" height="100%" viewBox="0 0 800 200" class="heatmap-chart">
                                    <!-- 背景框 -->
                                    <rect x="50" y="20" width="700" height="130" fill="#f9f9f9" stroke="#ccc" stroke-width="1"></rect>
                                    
                                    <!-- X轴标签 - 小时 -->
                                    <text x="100" y="170" text-anchor="middle" class="axis-label">0时</text>
                                    <text x="200" y="170" text-anchor="middle" class="axis-label">4时</text>
                                    <text x="300" y="170" text-anchor="middle" class="axis-label">8时</text>
                                    <text x="400" y="170" text-anchor="middle" class="axis-label">12时</text>
                                    <text x="500" y="170" text-anchor="middle" class="axis-label">16时</text>
                                    <text x="600" y="170" text-anchor="middle" class="axis-label">20时</text>
                                    <text x="700" y="170" text-anchor="middle" class="axis-label">24时</text>
                                    <text x="400" y="190" text-anchor="middle" font-weight="bold">时间点</text>
                                    
                                    <!-- Y轴标签 - 电表ID -->
                                    <text x="30" y="40" text-anchor="end" class="axis-label">表1</text>
                                    <text x="30" y="70" text-anchor="end" class="axis-label">表2</text>
                                    <text x="30" y="100" text-anchor="end" class="axis-label">表3</text>
                                    <text x="30" y="130" text-anchor="end" class="axis-label">表4</text>
                                    
                                    <!-- 热力图单元格 - 正常同步 -->
                                    <rect class="cell" x="50" y="20" width="100" height="30" fill="#e6f7ff"></rect>
                                    <rect class="cell" x="150" y="20" width="100" height="30" fill="#e6f7ff"></rect>
                                    <rect class="cell" x="250" y="20" width="100" height="30" fill="#e6f7ff"></rect>
                                    <rect class="cell" x="350" y="20" width="100" height="30" fill="#e6f7ff"></rect>
                                    <rect class="cell" x="450" y="20" width="100" height="30" fill="#e6f7ff"></rect>
                                    <rect class="cell" x="550" y="20" width="100" height="30" fill="#e6f7ff"></rect>
                                    <rect class="cell" x="650" y="20" width="100" height="30" fill="#e6f7ff"></rect>
                                    
                                    <rect class="cell" x="50" y="50" width="100" height="30" fill="#e6f7ff"></rect>
                                    <rect class="cell" x="150" y="50" width="100" height="30" fill="#bae7ff"></rect>
                                    <rect class="cell" x="250" y="50" width="100" height="30" fill="#bae7ff"></rect>
                                    <rect class="cell" x="350" y="50" width="100" height="30" fill="#e6f7ff"></rect>
                                    <rect class="cell" x="450" y="50" width="100" height="30" fill="#e6f7ff"></rect>
                                    <rect class="cell" x="550" y="50" width="100" height="30" fill="#e6f7ff"></rect>
                                    <rect class="cell" x="650" y="50" width="100" height="30" fill="#e6f7ff"></rect>
                                    
                                    <!-- 热力图单元格 - 轻微偏差 -->
                                    <rect class="cell" x="50" y="80" width="100" height="30" fill="#ffa39e"></rect>
                                    <rect class="cell" x="150" y="80" width="100" height="30" fill="#ffccc7"></rect>
                                    <rect class="cell" x="250" y="80" width="100" height="30" fill="#ff7875"></rect>
                                    <rect class="cell" x="350" y="80" width="100" height="30" fill="#ff4d4f"></rect>
                                    <rect class="cell" x="450" y="80" width="100" height="30" fill="#ff7875"></rect>
                                    <rect class="cell" x="550" y="80" width="100" height="30" fill="#ffccc7"></rect>
                                    <rect class="cell" x="650" y="80" width="100" height="30" fill="#ffa39e"></rect>
                                    
                                    <!-- 热力图单元格 - 严重偏差 -->
                                    <rect class="cell" x="50" y="110" width="100" height="30" fill="#ff7875"></rect>
                                    <rect class="cell" x="150" y="110" width="100" height="30" fill="#f5222d"></rect>
                                    <rect class="cell" x="250" y="110" width="100" height="30" fill="#cf1322"></rect>
                                    <rect class="cell" x="350" y="110" width="100" height="30" fill="#a8071a"></rect>
                                    <rect class="cell" x="450" y="110" width="100" height="30" fill="#cf1322"></rect>
                                    <rect class="cell" x="550" y="110" width="100" height="30" fill="#f5222d"></rect>
                                    <rect class="cell" x="650" y="110" width="100" height="30" fill="#ff7875"></rect>
                                    
                                    <!-- 标注单元格值 -->
                                    <text x="100" y="85" class="cell-label">3次</text>
                                    <text x="300" y="95" class="cell-label">6次</text>
                                    <text x="400" y="95" class="cell-label">7次</text>
                                    <text x="200" y="125" class="cell-label">8次</text>
                                    <text x="300" y="125" class="cell-label">11次</text>
                                    <text x="400" y="125" class="cell-label">12次</text>
                                    <text x="500" y="125" class="cell-label">9次</text>
                                    <text x="600" y="125" class="cell-label">8次</text>
                                    
                                    <!-- 标注 -->
                                    <text x="400" y="40" text-anchor="middle" fill="#f5222d" font-weight="bold" font-size="14">部分分表时钟同步事件异常频繁</text>
                                </svg>
                            </div>
                            <div class="chart-legend">
                                <div class="legend-item">
                                    <div class="legend-color" style="background-color: #e6f7ff;"></div>
                                    <span>正常(0-2次)</span>
                                </div>
                                <div class="legend-item">
                                    <div class="legend-color" style="background-color: #bae7ff;"></div>
                                    <span>偶发(3-4次)</span>
                                </div>
                                <div class="legend-item">
                                    <div class="legend-color" style="background-color: #ffa39e;"></div>
                                    <span>频繁(5-6次)</span>
                                </div>
                                <div class="legend-item">
                                    <div class="legend-color" style="background-color: #f5222d;"></div>
                                    <span>异常(7-10次)</span>
                                </div>
                                <div class="legend-item">
                                    <div class="legend-color" style="background-color: #a8071a;"></div>
                                    <span>严重(>10次)</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="indicator-group">
                    <h3>原因五：供电半径过长</h3>
                    <div class="indicator total">
                        <div class="indicator-name">供电半径过长指标(总表) (GM_SUPPLY_RADIUS_SCORE)</div>
                        <div class="indicator-desc">总表供电半径评分，通过电压降与额定电压比值评估</div>
                        <div class="indicator-formula">AVG(VOLTAGE_DROP) / RATED_VOLTAGE WHERE IsGM = 1</div>
                        <div class="visualization">
                            <div class="viz-title">台区电压降与供电半径关系示例</div>
                            <div class="chart">
                                <svg width="100%" height="100%" viewBox="0 0 800 200" class="scatter-chart">
                                    <!-- X轴 - 供电半径 -->
                                    <line x1="50" y1="150" x2="750" y2="150" stroke="#ccc" stroke-width="1"></line>
                                    <!-- Y轴 - 电压降 -->
                                    <line x1="50" y1="20" x2="50" y2="150" stroke="#ccc" stroke-width="1"></line>
                                    
                                    <!-- X轴刻度 -->
                                    <text x="150" y="170" text-anchor="middle" class="axis-label">0.5km</text>
                                    <text x="250" y="170" text-anchor="middle" class="axis-label">1.0km</text>
                                    <text x="350" y="170" text-anchor="middle" class="axis-label">1.5km</text>
                                    <text x="450" y="170" text-anchor="middle" class="axis-label">2.0km</text>
                                    <text x="550" y="170" text-anchor="middle" class="axis-label">2.5km</text>
                                    <text x="650" y="170" text-anchor="middle" class="axis-label">3.0km</text>
                                    <text x="400" y="190" text-anchor="middle" font-weight="bold">供电半径</text>
                                    
                                    <!-- Y轴刻度 -->
                                    <text x="40" y="150" text-anchor="end" class="axis-label">0%</text>
                                    <text x="40" y="120" text-anchor="end" class="axis-label">5%</text>
                                    <text x="40" y="90" text-anchor="end" class="axis-label">10%</text>
                                    <text x="40" y="60" text-anchor="end" class="axis-label">15%</text>
                                    <text x="40" y="30" text-anchor="end" class="axis-label">20%</text>
                                    <text x="20" y="85" text-anchor="middle" transform="rotate(-90, 20, 85)" font-weight="bold">电压降比例</text>
                                    
                                    <!-- 阈值线 -->
                                    <line x1="50" y1="90" x2="750" y2="90" stroke="#fa8c16" stroke-width="1.5" stroke-dasharray="5,5"></line>
                                    <text x="750" y="85" text-anchor="end" fill="#fa8c16" font-size="12">电压降阈值(10%)</text>
                                    
                                    <!-- 供电半径分组 -->
                                    <line x1="200" y1="20" x2="200" y2="150" stroke="#722ed1" stroke-width="1" stroke-dasharray="5,5"></line>
                                    <text x="200" y="15" text-anchor="middle" fill="#722ed1" font-size="12">短半径</text>
                                    
                                    <line x1="400" y1="20" x2="400" y2="150" stroke="#722ed1" stroke-width="1" stroke-dasharray="5,5"></line>
                                    <text x="400" y="15" text-anchor="middle" fill="#722ed1" font-size="12">中半径</text>
                                    
                                    <line x1="600" y1="20" x2="600" y2="150" stroke="#722ed1" stroke-width="1" stroke-dasharray="5,5"></line>
                                    <text x="600" y="15" text-anchor="middle" fill="#722ed1" font-size="12">长半径</text>
                                    
                                    <!-- 正常台区散点 -->
                                    <circle cx="100" cy="140" r="4" class="point" fill="#722ed1"></circle>
                                    <circle cx="130" cy="135" r="4" class="point" fill="#722ed1"></circle>
                                    <circle cx="160" cy="130" r="4" class="point" fill="#722ed1"></circle>
                                    <circle cx="180" cy="125" r="4" class="point" fill="#722ed1"></circle>
                                    
                                    <circle cx="230" cy="120" r="4" class="point" fill="#722ed1"></circle>
                                    <circle cx="280" cy="115" r="4" class="point" fill="#722ed1"></circle>
                                    <circle cx="320" cy="110" r="4" class="point" fill="#722ed1"></circle>
                                    <circle cx="350" cy="105" r="4" class="point" fill="#722ed1"></circle>
                                    <circle cx="370" cy="100" r="4" class="point" fill="#722ed1"></circle>
                                    
                                    <circle cx="420" cy="95" r="4" class="point" fill="#722ed1"></circle>
                                    <circle cx="450" cy="90" r="4" class="point" fill="#722ed1"></circle>
                                    
                                    <!-- 长半径异常台区散点 -->
                                    <circle cx="500" cy="80" r="5" class="point" fill="#f5222d"></circle>
                                    <circle cx="550" cy="60" r="5" class="point" fill="#f5222d"></circle>
                                    <circle cx="580" cy="50" r="5" class="point" fill="#f5222d"></circle>
                                    <circle cx="620" cy="40" r="5" class="point" fill="#f5222d"></circle>
                                    <circle cx="650" cy="35" r="6" class="point" fill="#f5222d"></circle>
                                    <circle cx="680" cy="30" r="6" class="point" fill="#f5222d"></circle>
                                    <circle cx="700" cy="25" r="6" class="point" fill="#f5222d"></circle>
                                    
                                    <!-- 趋势线 -->
                                    <path d="M50,145 L750,25" fill="none" stroke="#1890ff" stroke-width="2" stroke-dasharray="5,5"></path>
                                    
                                    <!-- 说明文字 -->
                                    <text x="400" y="50" text-anchor="middle" fill="#f5222d" font-weight="bold" font-size="14">供电半径超过2km的台区电压降显著增大</text>
                                </svg>
                            </div>
                            <div class="chart-legend">
                                <div class="legend-item">
                                    <div class="legend-color" style="background-color: #722ed1;"></div>
                                    <span>电压降正常台区</span>
                                </div>
                                <div class="legend-item">
                                    <div class="legend-color" style="background-color: #f5222d;"></div>
                                    <span>电压降异常台区</span>
                                </div>
                                <div class="legend-item">
                                    <div class="legend-color" style="background-color: #1890ff;"></div>
                                    <span>电压降-供电半径趋势线</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="indicator sub">
                        <div class="indicator-name">供电半径过长指标(分表) (SM_SUPPLY_RADIUS_SCORE)</div>
                        <div class="indicator-desc">分表供电半径评分，通过最小电压与最大电压比值及距离评估</div>
                        <div class="indicator-formula">1 - (MinVolMin / MaxVolMax) WHERE IsGM = 0</div>
                        <div class="visualization">
                            <div class="viz-title">分表最大/最小电压比值与距离关系示例</div>
                            <div class="chart">
                                <svg width="100%" height="100%" viewBox="0 0 800 200" class="line-chart">
                                    <!-- X轴 - 到总表距离 -->
                                    <line x1="50" y1="150" x2="750" y2="150" stroke="#ccc" stroke-width="1"></line>
                                    <!-- Y轴 - 电压降比值 -->
                                    <line x1="50" y1="20" x2="50" y2="150" stroke="#ccc" stroke-width="1"></line>
                                    
                                    <!-- X轴刻度 -->
                                    <text x="150" y="170" text-anchor="middle" class="axis-label">0.5km</text>
                                    <text x="250" y="170" text-anchor="middle" class="axis-label">1.0km</text>
                                    <text x="350" y="170" text-anchor="middle" class="axis-label">1.5km</text>
                                    <text x="450" y="170" text-anchor="middle" class="axis-label">2.0km</text>
                                    <text x="550" y="170" text-anchor="middle" class="axis-label">2.5km</text>
                                    <text x="650" y="170" text-anchor="middle" class="axis-label">3.0km</text>
                                    <text x="400" y="190" text-anchor="middle" font-weight="bold">供电半径</text>
                                    
                                    <!-- Y轴刻度 -->
                                    <text x="40" y="150" text-anchor="end" class="axis-label">0%</text>
                                    <text x="40" y="120" text-anchor="end" class="axis-label">5%</text>
                                    <text x="40" y="90" text-anchor="end" class="axis-label">10%</text>
                                    <text x="40" y="60" text-anchor="end" class="axis-label">15%</text>
                                    <text x="40" y="30" text-anchor="end" class="axis-label">20%</text>
                                    <text x="20" y="85" text-anchor="middle" transform="rotate(-90, 20, 85)" font-weight="bold">电压降比例</text>
                                    
                                    <!-- 阈值线 -->
                                    <line x1="50" y1="90" x2="750" y2="90" stroke="#fa8c16" stroke-width="1.5" stroke-dasharray="5,5"></line>
                                    <text x="750" y="85" text-anchor="end" fill="#fa8c16" font-size="12">电压降阈值(10%)</text>
                                    
                                    <!-- 供电半径分组 -->
                                    <line x1="200" y1="20" x2="200" y2="150" stroke="#722ed1" stroke-width="1" stroke-dasharray="5,5"></line>
                                    <text x="200" y="15" text-anchor="middle" fill="#722ed1" font-size="12">短半径</text>
                                    
                                    <line x1="400" y1="20" x2="400" y2="150" stroke="#722ed1" stroke-width="1" stroke-dasharray="5,5"></line>
                                    <text x="400" y="15" text-anchor="middle" fill="#722ed1" font-size="12">中半径</text>
                                    
                                    <line x1="600" y1="20" x2="600" y2="150" stroke="#722ed1" stroke-width="1" stroke-dasharray="5,5"></line>
                                    <text x="600" y="15" text-anchor="middle" fill="#722ed1" font-size="12">长半径</text>
                                    
                                    <!-- 正常台区散点 -->
                                    <circle cx="100" cy="140" r="4" class="point" fill="#722ed1"></circle>
                                    <circle cx="130" cy="135" r="4" class="point" fill="#722ed1"></circle>
                                    <circle cx="160" cy="130" r="4" class="point" fill="#722ed1"></circle>
                                    <circle cx="180" cy="125" r="4" class="point" fill="#722ed1"></circle>
                                    
                                    <circle cx="230" cy="120" r="4" class="point" fill="#722ed1"></circle>
                                    <circle cx="280" cy="115" r="4" class="point" fill="#722ed1"></circle>
                                    <circle cx="320" cy="110" r="4" class="point" fill="#722ed1"></circle>
                                    <circle cx="350" cy="105" r="4" class="point" fill="#722ed1"></circle>
                                    <circle cx="370" cy="100" r="4" class="point" fill="#722ed1"></circle>
                                    
                                    <circle cx="420" cy="95" r="4" class="point" fill="#722ed1"></circle>
                                    <circle cx="450" cy="90" r="4" class="point" fill="#722ed1"></circle>
                                    
                                    <!-- 长半径异常台区散点 -->
                                    <circle cx="500" cy="80" r="5" class="point" fill="#f5222d"></circle>
                                    <circle cx="550" cy="60" r="5" class="point" fill="#f5222d"></circle>
                                    <circle cx="580" cy="50" r="5" class="point" fill="#f5222d"></circle>
                                    <circle cx="620" cy="40" r="5" class="point" fill="#f5222d"></circle>
                                    <circle cx="650" cy="35" r="6" class="point" fill="#f5222d"></circle>
                                    <circle cx="680" cy="30" r="6" class="point" fill="#f5222d"></circle>
                                    <circle cx="700" cy="25" r="6" class="point" fill="#f5222d"></circle>
                                    
                                    <!-- 趋势线 -->
                                    <path d="M50,145 L750,25" fill="none" stroke="#1890ff" stroke-width="2" stroke-dasharray="5,5"></path>
                                    
                                    <!-- 说明文字 -->
                                    <text x="400" y="50" text-anchor="middle" fill="#f5222d" font-weight="bold" font-size="14">供电半径超过2km的台区电压降显著增大</text>
                                </svg>
                            </div>
                            <div class="chart-legend">
                                <div class="legend-item">
                                    <div class="legend-color" style="background-color: #722ed1;"></div>
                                    <span>电压降正常台区</span>
                                </div>
                                <div class="legend-item">
                                    <div class="legend-color" style="background-color: #f5222d;"></div>
                                    <span>电压降异常台区</span>
                                </div>
                                <div class="legend-item">
                                    <div class="legend-color" style="background-color: #1890ff;"></div>
                                    <span>电压降-供电半径趋势线</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="indicator-group">
                    <h3>综合评分</h3>
                    <div class="indicator">
                        <div class="indicator-name">长期高损综合评分 (LONG_TERM_HIGH_LOSS_SCORE)</div>
                        <div class="indicator-desc">综合评估台区长期高损风险的评分，通过各项指标加权计算</div>
                        <div class="indicator-formula">0.3*NORM(LOSS_RATIO) + 0.15*NORM(GM_CT_ABNORMAL_RATIO) + 0.15*NORM(GM_METER_RELATION_ERROR) + 0.15*NORM(GM_THEFT_DETECTION) + 0.1*NORM(GM_CLOCK_SYNC_DEVIATION) + 0.15*NORM(GM_SUPPLY_RADIUS_SCORE)</div>
                        <div class="visualization">
                            <div class="viz-title">台区长期高损综合评分示例</div>
                            <div class="chart">
                                <svg width="100%" height="100%" viewBox="0 0 800 200">
                                    <!-- 背景矩形 -->
                                    <rect x="50" y="20" width="700" height="130" fill="#f9f9f9" stroke="#ccc" stroke-width="1"></rect>
                                    
                                    <!-- 台区评分柱状图 -->
                                    <g transform="translate(100, 0)">
                                        <!-- 台区1 - 多因素综合导致 -->
                                        <text x="0" y="40" text-anchor="end" font-size="12">台区A</text>
                                        <rect x="10" y="30" width="600" height="15" fill="#e6f7ff" stroke="#ccc" stroke-width="0.5"></rect>
                                        <rect x="10" y="30" width="180" height="15" fill="#1890ff"></rect>
                                        <rect x="10" y="30" width="90" height="15" fill="#722ed1"></rect>
                                        <rect x="100" y="30" width="90" height="15" fill="#f5222d"></rect>
                                        <rect x="190" y="30" width="60" height="15" fill="#fa8c16"></rect>
                                        <rect x="250" y="30" width="45" height="15" fill="#13c2c2"></rect>
                                        <rect x="295" y="30" width="75" height="15" fill="#52c41a"></rect>
                                        <text x="620" y="40" text-anchor="start" fill="#1890ff" font-weight="bold" font-size="12">92分</text>
                                        
                                        <!-- 台区2 - 窃电为主 -->
                                        <text x="0" y="65" text-anchor="end" font-size="12">台区B</text>
                                        <rect x="10" y="55" width="600" height="15" fill="#e6f7ff" stroke="#ccc" stroke-width="0.5"></rect>
                                        <rect x="10" y="55" width="150" height="15" fill="#1890ff"></rect>
                                        <rect x="10" y="55" width="30" height="15" fill="#722ed1"></rect>
                                        <rect x="40" y="55" width="160" height="15" fill="#f5222d"></rect>
                                        <rect x="200" y="55" width="20" height="15" fill="#fa8c16"></rect>
                                        <rect x="220" y="55" width="15" height="15" fill="#13c2c2"></rect>
                                        <text x="620" y="65" text-anchor="start" fill="#1890ff" font-weight="bold" font-size="12">85分</text>
                                        
                                        <!-- 台区3 - CT异常为主 -->
                                        <text x="0" y="90" text-anchor="end" font-size="12">台区C</text>
                                        <rect x="10" y="80" width="600" height="15" fill="#e6f7ff" stroke="#ccc" stroke-width="0.5"></rect>
                                        <rect x="10" y="80" width="120" height="15" fill="#1890ff"></rect>
                                        <rect x="10" y="80" width="150" height="15" fill="#722ed1"></rect>
                                        <rect x="160" y="80" width="20" height="15" fill="#f5222d"></rect>
                                        <rect x="180" y="80" width="15" height="15" fill="#fa8c16"></rect>
                                        <rect x="195" y="80" width="20" height="15" fill="#13c2c2"></rect>
                                        <text x="620" y="90" text-anchor="start" fill="#1890ff" font-weight="bold" font-size="12">78分</text>
                                        
                                        <!-- 台区4 - 供电半径为主 -->
                                        <text x="0" y="115" text-anchor="end" font-size="12">台区D</text>
                                        <rect x="10" y="105" width="600" height="15" fill="#e6f7ff" stroke="#ccc" stroke-width="0.5"></rect>
                                        <rect x="10" y="105" width="100" height="15" fill="#1890ff"></rect>
                                        <rect x="10" y="105" width="20" height="15" fill="#722ed1"></rect>
                                        <rect x="30" y="105" width="15" height="15" fill="#f5222d"></rect>
                                        <rect x="45" y="105" width="25" height="15" fill="#fa8c16"></rect>
                                        <rect x="70" y="105" width="120" height="15" fill="#13c2c2"></rect>
                                        <text x="620" y="115" text-anchor="start" fill="#1890ff" font-weight="bold" font-size="12">70分</text>
                                        
                                        <!-- 台区5 - 户表关系为主 -->
                                        <text x="0" y="140" text-anchor="end" font-size="12">台区E</text>
                                        <rect x="10" y="130" width="600" height="15" fill="#e6f7ff" stroke="#ccc" stroke-width="0.5"></rect>
                                        <rect x="10" y="130" width="80" height="15" fill="#1890ff"></rect>
                                        <rect x="10" y="130" width="15" height="15" fill="#722ed1"></rect>
                                        <rect x="25" y="130" width="120" height="15" fill="#fa8c16"></rect>
                                        <rect x="145" y="130" width="15" height="15" fill="#13c2c2"></rect>
                                        <text x="620" y="140" text-anchor="start" fill="#1890ff" font-weight="bold" font-size="12">65分</text>
                                    </g>
                                    
                                    <!-- 图例 -->
                                    <text x="400" y="170" text-anchor="middle" class="axis-label" font-weight="bold">综合得分及构成要素</text>
                                </svg>
                            </div>
                            <div class="chart-legend">
                                <div class="legend-item">
                                    <div class="legend-color" style="background-color: #722ed1;"></div>
                                    <span>CT倍率异常</span>
                                </div>
                                <div class="legend-item">
                                    <div class="legend-color" style="background-color: #f5222d;"></div>
                                    <span>窃电行为</span>
                                </div>
                                <div class="legend-item">
                                    <div class="legend-color" style="background-color: #fa8c16;"></div>
                                    <span>户表关系错误</span>
                                </div>
                                <div class="legend-item">
                                    <div class="legend-color" style="background-color: #13c2c2;"></div>
                                    <span>供电半径过长</span>
                                </div>
                                <div class="legend-item">
                                    <div class="legend-color" style="background-color: #52c41a;"></div>
                                    <span>时钟同步偏差</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="card">
            <div class="card-header">长期高损指标汇总表</div>
            <div class="card-body">
                <table>
                    <thead>
                        <tr>
                            <th>指标类别</th>
                            <th>总表指标</th>
                            <th>分表指标</th>
                            <th>数据来源</th>
                            <th>判定阈值</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>CT倍率互感器异常</td>
                            <td>GM_CT_ABNORMAL_RATIO</td>
                            <td>SM_CT_ABNORMAL_RATIO</td>
                            <td>C_AR_CT_PT_CHANGE_LOG</td>
                            <td>比值变化 > 20%</td>
                        </tr>
                        <tr>
                            <td>台区户表关系错误</td>
                            <td>GM_METER_RELATION_ERROR</td>
                            <td>SM_METER_RELATION_ERROR</td>
                            <td>户变关系变更记录</td>
                            <td>相关性 < 0.6</td>
                        </tr>
                        <tr>
                            <td>窃电行为</td>
                            <td>GM_THEFT_DETECTION</td>
                            <td>SM_THEFT_DETECTION</td>
                            <td>异常用电大宽表</td>
                            <td>差值 > 5%或事件次数 > 3</td>
                        </tr>
                        <tr>
                            <td>时钟同步偏差</td>
                            <td>GM_CLOCK_SYNC_DEVIATION</td>
                            <td>SM_CLOCK_SYNC_DEVIATION</td>
                            <td>异常用电大宽表</td>
                            <td>事件次数 > 5</td>
                        </tr>
                        <tr>
                            <td>供电半径过长</td>
                            <td>GM_SUPPLY_RADIUS_SCORE</td>
                            <td>SM_SUPPLY_RADIUS_SCORE</td>
                            <td>区域档案, 异常用电大宽表</td>
                            <td>比值 > 10%</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <div class="card">
            <div class="card-header">长期高损分析应用流程</div>
            <div class="card-body">
                <ol>
                    <li>基于台区高损持续天数(TQ_HIGH_LOSS_DAYS)，筛选出连续高损超过30天的台区</li>
                    <li>计算长期高损台区的综合评分(LONG_TERM_HIGH_LOSS_SCORE)，按照得分从高到低排序</li>
                    <li>对于每个台区，分别计算5个原因类别的总表和分表指标值</li>
                    <li>根据各指标的阈值，判断导致长期高损的最可能原因</li>
                    <li>针对性制定现场核查和整改措施</li>
                </ol>
            </div>
        </div>

        <div class="diagram">
            <!-- SVG示意图将通过数据可视化工具生成 -->
            <svg>
                <g transform="translate(50, 20)">
                    <!-- 主节点 -->
                    <g transform="translate(450, 200)">
                        <rect width="150" height="60" rx="5" ry="5" fill="#1890ff" stroke="#1890ff"></rect>
                        <text x="75" y="35" text-anchor="middle" fill="white" font-weight="bold">长期高损</text>
                    </g>
                    
                    <!-- 原因节点 -->
                    <g transform="translate(200, 50)">
                        <rect width="150" height="50" rx="5" ry="5" fill="#722ed1" stroke="#722ed1"></rect>
                        <text x="75" y="30" text-anchor="middle" fill="white">CT倍率互感器异常</text>
                    </g>
                    <g transform="translate(400, 50)">
                        <rect width="150" height="50" rx="5" ry="5" fill="#722ed1" stroke="#722ed1"></rect>
                        <text x="75" y="30" text-anchor="middle" fill="white">台区户表关系错误</text>
                    </g>
                    <g transform="translate(600, 50)">
                        <rect width="150" height="50" rx="5" ry="5" fill="#722ed1" stroke="#722ed1"></rect>
                        <text x="75" y="30" text-anchor="middle" fill="white">窃电行为</text>
                    </g>
                    <g transform="translate(300, 350)">
                        <rect width="150" height="50" rx="5" ry="5" fill="#722ed1" stroke="#722ed1"></rect>
                        <text x="75" y="30" text-anchor="middle" fill="white">时钟同步偏差</text>
                    </g>
                    <g transform="translate(600, 350)">
                        <rect width="150" height="50" rx="5" ry="5" fill="#722ed1" stroke="#722ed1"></rect>
                        <text x="75" y="30" text-anchor="middle" fill="white">供电半径过长</text>
                    </g>
                    
                    <!-- 连接线 -->
                    <line x1="275" y1="100" x2="450" y2="200" stroke="#333" stroke-width="2"></line>
                    <line x1="475" y1="100" x2="475" y2="200" stroke="#333" stroke-width="2"></line>
                    <line x1="675" y1="100" x2="525" y2="200" stroke="#333" stroke-width="2"></line>
                    <line x1="375" y1="350" x2="450" y2="260" stroke="#333" stroke-width="2"></line>
                    <line x1="675" y1="350" x2="525" y2="260" stroke="#333" stroke-width="2"></line>
                </g>
            </svg>
        </div>

        <footer>
            <p>© 2023 电网线损分析系统 - 长期高损指标体系 v1.0</p>
        </footer>
    </div>
</body>
</html> 