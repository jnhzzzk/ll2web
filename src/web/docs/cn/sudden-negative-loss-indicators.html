<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>突发负损原因分析指标体系</title>
    <style>
        body {
            font-family: 'PingFang SC', 'Microsoft YaHei', sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f5f7fa;
            color: #333;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        header {
            background-color: #1890ff;
            color: white;
            padding: 20px;
            text-align: center;
            border-radius: 5px;
            margin-bottom: 30px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        h1 {
            margin: 0;
            font-size: 28px;
        }
        .card {
            background-color: white;
            border-radius: 5px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
            overflow: hidden;
        }
        .card-header {
            background-color: #e6f7ff;
            padding: 15px 20px;
            border-bottom: 1px solid #e8e8e8;
            font-weight: bold;
            font-size: 18px;
            color: #1890ff;
        }
        .card-body {
            padding: 20px;
        }
        .indicator-group {
            margin-bottom: 30px;
        }
        .indicator {
            border-left: 4px solid #1890ff;
            padding: 10px 15px;
            margin-bottom: 15px;
            background-color: #f0f8ff;
            border-radius: 0 4px 4px 0;
        }
        .indicator.total {
            border-left-color: #722ed1;
            background-color: #f9f0ff;
        }
        .indicator.sub {
            border-left-color: #13c2c2;
            background-color: #e6fffb;
        }
        .indicator-name {
            font-weight: bold;
            margin-bottom: 5px;
        }
        .indicator-desc {
            color: #666;
            font-size: 14px;
            margin-bottom: 5px;
        }
        .indicator-formula {
            font-family: 'Courier New', monospace;
            background-color: #f5f5f5;
            padding: 8px;
            border-radius: 4px;
            font-size: 14px;
            margin-top: 10px;
        }
        .visualization {
            margin-top: 15px;
            border: 1px solid #e8e8e8;
            border-radius: 4px;
            padding: 15px;
            background-color: white;
        }
        .viz-title {
            font-weight: bold;
            margin-bottom: 10px;
            color: #1890ff;
            font-size: 14px;
        }
        .chart {
            width: 100%;
            height: 200px;
            position: relative;
        }
        .chart-legend {
            display: flex;
            justify-content: center;
            margin-top: 10px;
            font-size: 12px;
        }
        .legend-item {
            display: flex;
            align-items: center;
            margin: 0 10px;
        }
        .legend-color {
            width: 12px;
            height: 12px;
            border-radius: 2px;
            margin-right: 5px;
        }
        .axis-label {
            font-size: 12px;
            color: #666;
        }
        .relationships {
            border: 1px solid #e8e8e8;
            border-radius: 5px;
            padding: 20px;
            margin-top: 20px;
        }
        .diagram {
            width: 100%;
            height: 500px;
            margin: 30px 0;
            border: 1px solid #e8e8e8;
            border-radius: 5px;
            background-color: white;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        svg {
            width: 100%;
            height: 100%;
        }
        .node rect {
            stroke: #999;
            fill: #fff;
            stroke-width: 1.5px;
        }
        .edgePath path {
            stroke: #333;
            stroke-width: 1.5px;
        }
        footer {
            text-align: center;
            margin-top: 30px;
            padding: 20px;
            color: #666;
            font-size: 14px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }
        th {
            background-color: #f5f7fa;
            font-weight: bold;
        }
        tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        tr:hover {
            background-color: #f0f8ff;
        }
        .bar-chart .bar {
            fill: #1890ff;
            transition: fill 0.3s;
        }
        .bar-chart .bar:hover {
            fill: #69c0ff;
        }
        .bar-chart .bar-label {
            font-size: 12px;
            text-anchor: middle;
        }
        .line-chart .line {
            fill: none;
            stroke: #1890ff;
            stroke-width: 2;
        }
        .line-chart .point {
            fill: #1890ff;
        }
        .line-chart .line.threshold {
            stroke: #f5222d;
            stroke-dasharray: 5,5;
        }
        .line-chart .area {
            fill: rgba(24, 144, 255, 0.1);
        }
        .line-chart .area.above-threshold {
            fill: rgba(245, 34, 45, 0.1);
        }
        .scatter-chart .point {
            fill: #1890ff;
            transition: r 0.3s;
        }
        .scatter-chart .point:hover {
            r: 6;
        }
        .scatter-chart .correlation-line {
            stroke: #722ed1;
            stroke-width: 2;
            stroke-dasharray: 5,5;
        }
        .heatmap-chart .cell {
            stroke: white;
            stroke-width: 1;
        }
        .heatmap-chart .cell-label {
            font-size: 10px;
            text-anchor: middle;
            dominant-baseline: middle;
            fill: white;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>突发负损原因分析指标体系</h1>
        </header>

        <div class="card">
            <div class="card-header">突发负损概述</div>
            <div class="card-body">
                <p>突发负损是指台区线损率突然变为负值的现象，通常指线损率从正常值骤降为负值。负线损在物理上是不合理的，表明计量或关联关系存在问题。</p>
                <p>本指标体系通过设计一系列与突发负损密切相关的诊断指标，为快速定位和解决突发负损问题提供数据支持。</p>
            </div>
        </div>

        <div class="card">
            <div class="card-header">突发负损可能原因及指标体系</div>
            <div class="card-body">
                <div class="indicator-group">
                    <h3>基础判定指标</h3>
                    <div class="indicator">
                        <div class="indicator-name">突发负损检测 (SUDDEN_NEGATIVE_LOSS_DETECTION)</div>
                        <div class="indicator-desc">检测台区线损率的突发性降低为负值，通常出现在设备变更、户表关系变更、天气异常或计量装置维护后</div>
                        <div class="indicator-formula">AVG(LOSS_RATIO OVER PREV_5_DAYS) - LOSS_RATIO WHERE (PREV_LOSS_RATIO - LOSS_RATIO) > SUDDEN_DECREASE_THRESHOLD AND LOSS_RATIO < 0</div>
                        <div class="visualization">
                            <div class="viz-title">某台区突发负损检测示例</div>
                            <div class="chart">
                                <svg width="100%" height="100%" viewBox="0 0 800 200">
                                    <!-- X轴 -->
                                    <line x1="50" y1="150" x2="750" y2="150" stroke="#ccc" stroke-width="1"></line>
                                    <!-- Y轴 -->
                                    <line x1="50" y1="20" x2="50" y2="180" stroke="#ccc" stroke-width="1"></line>
                                    
                                    <!-- X轴刻度 - 时间 -->
                                    <text x="100" y="170" text-anchor="middle" class="axis-label">11/1</text>
                                    <text x="200" y="170" text-anchor="middle" class="axis-label">11/3</text>
                                    <text x="300" y="170" text-anchor="middle" class="axis-label">11/5</text>
                                    <text x="400" y="170" text-anchor="middle" class="axis-label">11/7</text>
                                    <text x="500" y="170" text-anchor="middle" class="axis-label">11/9</text>
                                    <text x="600" y="170" text-anchor="middle" class="axis-label">11/11</text>
                                    <text x="700" y="170" text-anchor="middle" class="axis-label">11/13</text>
                                    
                                    <!-- Y轴刻度 - 线损率 -->
                                    <text x="40" y="180" text-anchor="end" class="axis-label">-5%</text>
                                    <text x="40" y="150" text-anchor="end" class="axis-label">0%</text>
                                    <text x="40" y="120" text-anchor="end" class="axis-label">5%</text>
                                    <text x="40" y="90" text-anchor="end" class="axis-label">10%</text>
                                    <text x="40" y="60" text-anchor="end" class="axis-label">15%</text>
                                    <text x="40" y="30" text-anchor="end" class="axis-label">20%</text>
                                    
                                    <!-- 零线 -->
                                    <line x1="50" y1="150" x2="750" y2="150" stroke="#000" stroke-width="1.5"></line>
                                    
                                    <!-- 线损率曲线 -->
                                    <path d="M50,90 Q100,85 150,95 T250,90 T350,100 T400,95" fill="none" stroke="#1890ff" stroke-width="2"></path>
                                    
                                    <!-- 突变点 -->
                                    <line x1="400" y1="20" x2="400" y2="180" stroke="#f5222d" stroke-width="1.5" stroke-dasharray="5,5"></line>
                                    <text x="400" y="20" text-anchor="middle" fill="#f5222d" font-size="12" font-weight="bold">突变点</text>
                                    
                                    <!-- 突变后负损曲线 -->
                                    <path d="M400,95 L450,175 L500,180 L550,175 L600,170 L650,175 L700,170 L750,175" fill="none" stroke="#f5222d" stroke-width="2"></path>
                                    
                                    <!-- 负损区域标记 -->
                                    <path d="M400,150 L450,175 L500,180 L550,175 L600,170 L650,175 L700,170 L750,175 L750,150 Z" fill="rgba(245, 34, 45, 0.1)"></path>
                                    
                                    <!-- 负损标记 -->
                                    <circle cx="500" cy="180" r="5" fill="#f5222d"></circle>
                                    <text x="520" y="190" fill="#f5222d" font-size="12" font-weight="bold">线损率突变为-3.4%</text>
                                </svg>
                            </div>
                            <div class="chart-legend">
                                <div class="legend-item">
                                    <div class="legend-color" style="background-color: #1890ff;"></div>
                                    <span>正常线损率曲线</span>
                                </div>
                                <div class="legend-item">
                                    <div class="legend-color" style="background-color: #f5222d;"></div>
                                    <span>突发负损曲线</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="indicator-group">
                    <h3>原因一：CT倍率互感器异常</h3>
                    <div class="indicator total">
                        <div class="indicator-name">CT倍率突变负损指标(总表) (GM_CT_SUDDEN_NEGATIVE)</div>
                        <div class="indicator-desc">总表CT倍率突变导致负损评分，评估CT倍率变更前后线损率的突变情况</div>
                        <div class="indicator-formula">ABS((NEW_RATE/OLD_RATE) - 1) * 100 WHERE CT_PT_TYPE = 'CT' AND IsGM = 1 AND DATEDIFF(STATIS_DATE, CHANGE_TIME) <= 3 AND LOSS_RATIO < 0</div>
                        <div class="visualization">
                            <div class="viz-title">总表CT倍率变更与负损关系示例</div>
                            <div class="chart">
                                <svg width="100%" height="100%" viewBox="0 0 800 200" class="bar-chart">
                                    <!-- X轴 -->
                                    <line x1="50" y1="150" x2="750" y2="150" stroke="#ccc" stroke-width="1"></line>
                                    <!-- Y轴 -->
                                    <line x1="50" y1="20" x2="50" y2="180" stroke="#ccc" stroke-width="1"></line>
                                    
                                    <!-- X轴刻度 -->
                                    <text x="150" y="170" text-anchor="middle" class="axis-label">变更前3日</text>
                                    <text x="250" y="170" text-anchor="middle" class="axis-label">变更前2日</text>
                                    <text x="350" y="170" text-anchor="middle" class="axis-label">变更前1日</text>
                                    <line x1="400" y1="20" x2="400" y2="170" stroke="#722ed1" stroke-width="2" stroke-dasharray="5,5"></line>
                                    <text x="400" y="185" text-anchor="middle" class="axis-label" fill="#722ed1" font-weight="bold">CT倍率变更</text>
                                    <text x="450" y="170" text-anchor="middle" class="axis-label">变更后1日</text>
                                    <text x="550" y="170" text-anchor="middle" class="axis-label">变更后2日</text>
                                    <text x="650" y="170" text-anchor="middle" class="axis-label">变更后3日</text>
                                    
                                    <!-- Y轴刻度 -->
                                    <text x="40" y="180" text-anchor="end" class="axis-label">-5%</text>
                                    <text x="40" y="150" text-anchor="end" class="axis-label">0%</text>
                                    <text x="40" y="120" text-anchor="end" class="axis-label">5%</text>
                                    <text x="40" y="90" text-anchor="end" class="axis-label">10%</text>
                                    <text x="40" y="60" text-anchor="end" class="axis-label">15%</text>
                                    
                                    <!-- 零线 -->
                                    <line x1="50" y1="150" x2="750" y2="150" stroke="#000" stroke-width="1"></line>
                                    
                                    <!-- 变更前线损率柱形图 -->
                                    <rect class="bar" x="120" y="85" width="60" height="65" fill="#722ed1"></rect>
                                    <rect class="bar" x="220" y="90" width="60" height="60" fill="#722ed1"></rect>
                                    <rect class="bar" x="320" y="80" width="60" height="70" fill="#722ed1"></rect>
                                    
                                    <!-- 变更后线损率柱形图（负值） -->
                                    <rect class="bar" x="420" y="150" width="60" height="20" fill="#f5222d"></rect>
                                    <rect class="bar" x="520" y="150" width="60" height="25" fill="#f5222d"></rect>
                                    <rect class="bar" x="620" y="150" width="60" height="27" fill="#f5222d"></rect>
                                    
                                    <!-- 柱形图标签 -->
                                    <text x="150" y="80" text-anchor="middle" class="bar-label">9.2%</text>
                                    <text x="250" y="85" text-anchor="middle" class="bar-label">8.7%</text>
                                    <text x="350" y="75" text-anchor="middle" class="bar-label">9.5%</text>
                                    <text x="450" y="175" text-anchor="middle" class="bar-label" fill="#f5222d" font-weight="bold">-2.9%</text>
                                    <text x="550" y="180" text-anchor="middle" class="bar-label" fill="#f5222d" font-weight="bold">-3.5%</text>
                                    <text x="650" y="182" text-anchor="middle" class="bar-label" fill="#f5222d" font-weight="bold">-3.8%</text>
                                    
                                    <!-- 变化率标注 -->
                                    <text x="550" y="30" text-anchor="middle" fill="#f5222d" font-weight="bold" font-size="14">CT倍率变更导致线损率突变为负值</text>
                                    <text x="550" y="50" text-anchor="middle" fill="#f5222d" font-size="12">总表CT倍率从500/5变更为400/5</text>
                                </svg>
                            </div>
                            <div class="chart-legend">
                                <div class="legend-item">
                                    <div class="legend-color" style="background-color: #722ed1;"></div>
                                    <span>变更前线损率</span>
                                </div>
                                <div class="legend-item">
                                    <div class="legend-color" style="background-color: #f5222d;"></div>
                                    <span>变更后线损率(负值)</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="indicator sub">
                        <div class="indicator-name">CT倍率突变负损指标(分表) (SM_CT_SUDDEN_NEGATIVE)</div>
                        <div class="indicator-desc">分表CT倍率突变导致负损评分，评估CT倍率变更前后分表用电量的突变情况</div>
                        <div class="indicator-formula">ABS((NEW_RATE/OLD_RATE) - 1) * 100 WHERE CT_PT_TYPE = 'CT' AND IsGM = 0 AND DATEDIFF(FreezeDate, CHANGE_TIME) <= 3 AND REGION_LOSS_RATIO < 0</div>
                        <div class="visualization">
                            <div class="viz-title">分表CT倍率变更前后用电量变化示例</div>
                            <div class="chart">
                                <svg width="100%" height="100%" viewBox="0 0 800 200" class="line-chart">
                                    <!-- X轴 -->
                                    <line x1="50" y1="150" x2="750" y2="150" stroke="#ccc" stroke-width="1"></line>
                                    <!-- Y轴 -->
                                    <line x1="50" y1="20" x2="50" y2="150" stroke="#ccc" stroke-width="1"></line>
                                    
                                    <!-- X轴刻度 -->
                                    <text x="100" y="170" text-anchor="middle" class="axis-label">11/1</text>
                                    <text x="200" y="170" text-anchor="middle" class="axis-label">11/3</text>
                                    <text x="300" y="170" text-anchor="middle" class="axis-label">11/5</text>
                                    <line x1="400" y1="20" x2="400" y2="170" stroke="#13c2c2" stroke-width="2" stroke-dasharray="5,5"></line>
                                    <text x="400" y="185" text-anchor="middle" class="axis-label" fill="#13c2c2" font-weight="bold">CT倍率变更</text>
                                    <text x="500" y="170" text-anchor="middle" class="axis-label">11/8</text>
                                    <text x="600" y="170" text-anchor="middle" class="axis-label">11/10</text>
                                    <text x="700" y="170" text-anchor="middle" class="axis-label">11/12</text>
                                    
                                    <!-- Y轴刻度 -->
                                    <text x="40" y="150" text-anchor="end" class="axis-label">0</text>
                                    <text x="40" y="120" text-anchor="end" class="axis-label">500</text>
                                    <text x="40" y="90" text-anchor="end" class="axis-label">1000</text>
                                    <text x="40" y="60" text-anchor="end" class="axis-label">1500</text>
                                    <text x="40" y="30" text-anchor="end" class="axis-label">2000</text>
                                    
                                    <!-- 正常趋势线 -->
                                    <path d="M50,120 L100,115 L200,125 L300,110 L400,115" class="line" stroke="#13c2c2"></path>
                                    <circle cx="100" cy="115" r="4" class="point" fill="#13c2c2"></circle>
                                    <circle cx="200" cy="125" r="4" class="point" fill="#13c2c2"></circle>
                                    <circle cx="300" cy="110" r="4" class="point" fill="#13c2c2"></circle>
                                    <circle cx="400" cy="115" r="4" class="point" fill="#13c2c2"></circle>
                                    
                                    <!-- 异常趋势线 -->
                                    <path d="M400,115 L500,60 L600,55 L700,50" class="line" stroke="#f5222d"></path>
                                    <circle cx="500" cy="60" r="4" class="point" fill="#f5222d"></circle>
                                    <circle cx="600" cy="55" r="4" class="point" fill="#f5222d"></circle>
                                    <circle cx="700" cy="50" r="4" class="point" fill="#f5222d"></circle>
                                    
                                    <!-- 异常标注 -->
                                    <text x="600" y="35" text-anchor="middle" fill="#f5222d" font-weight="bold" font-size="14">分表CT倍率变更导致用电量突增近100%</text>
                                    <text x="600" y="55" text-anchor="middle" fill="#f5222d" font-size="12">分表CT倍率从100/5变更为200/5</text>
                                </svg>
                            </div>
                            <div class="chart-legend">
                                <div class="legend-item">
                                    <div class="legend-color" style="background-color: #13c2c2;"></div>
                                    <span>变更前用电量趋势</span>
                                </div>
                                <div class="legend-item">
                                    <div class="legend-color" style="background-color: #f5222d;"></div>
                                    <span>变更后用电量趋势(异常增加)</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="indicator-group">
                    <h3>原因二：台区户表关系错误</h3>
                    <div class="indicator total">
                        <div class="indicator-name">户表关系突变负损指标(总表) (GM_RELATION_SUDDEN_NEGATIVE)</div>
                        <div class="indicator-desc">总表关联户表突变导致负损程度，评估户表关系变更是否导致线损率突变为负值</div>
                        <div class="indicator-formula">LOSS_RATIO - PRE_CHANGE_LOSS_RATIO WHERE DATEDIFF(STATIS_DATE, CHANGE_TIME) <= 3 AND LOSS_RATIO < 0</div>
                        <div class="visualization">
                            <div class="viz-title">户表关系变更前后线损率变化示例</div>
                            <div class="chart">
                                <svg width="100%" height="100%" viewBox="0 0 800 200" class="line-chart">
                                    <!-- X轴 -->
                                    <line x1="50" y1="150" x2="750" y2="150" stroke="#ccc" stroke-width="1"></line>
                                    <!-- Y轴 -->
                                    <line x1="50" y1="20" x2="50" y2="180" stroke="#ccc" stroke-width="1"></line>
                                    
                                    <!-- X轴刻度 - 30天 -->
                                    <text x="120" y="170" text-anchor="middle" class="axis-label">11/1</text>
                                    <text x="200" y="170" text-anchor="middle" class="axis-label">11/3</text>
                                    <text x="280" y="170" text-anchor="middle" class="axis-label">11/5</text>
                                    <text x="360" y="170" text-anchor="middle" class="axis-label">11/7</text>
                                    
                                    <!-- 户表关系变更点 -->
                                    <line x1="400" y1="20" x2="400" y2="180" stroke="#fa8c16" stroke-width="2" stroke-dasharray="5,5"></line>
                                    <text x="400" y="15" text-anchor="middle" fill="#fa8c16" font-size="12" font-weight="bold">户表关系变更</text>
                                    
                                    <text x="480" y="170" text-anchor="middle" class="axis-label">11/9</text>
                                    <text x="560" y="170" text-anchor="middle" class="axis-label">11/11</text>
                                    <text x="640" y="170" text-anchor="middle" class="axis-label">11/13</text>
                                    <text x="720" y="170" text-anchor="middle" class="axis-label">11/15</text>
                                    
                                    <!-- Y轴刻度 - 线损率 -->
                                    <text x="40" y="180" text-anchor="end" class="axis-label">-5%</text>
                                    <text x="40" y="150" text-anchor="end" class="axis-label">0%</text>
                                    <text x="40" y="120" text-anchor="end" class="axis-label">5%</text>
                                    <text x="40" y="90" text-anchor="end" class="axis-label">10%</text>
                                    <text x="40" y="60" text-anchor="end" class="axis-label">15%</text>
                                    
                                    <!-- 零线 -->
                                    <line x1="50" y1="150" x2="750" y2="150" stroke="#000" stroke-width="1"></line>
                                    
                                    <!-- 变更前线损率曲线 -->
                                    <path d="M50,95 L120,90 L200,100 L280,95 L400,98" fill="none" stroke="#722ed1" stroke-width="2"></path>
                                    
                                    <!-- 变更后线损率曲线 -->
                                    <path d="M400,98 L480,170 L560,175 L640,172 L720,168" fill="none" stroke="#f5222d" stroke-width="2"></path>
                                    
                                    <!-- 负损区域标记 -->
                                    <path d="M400,150 L480,170 L560,175 L640,172 L720,168 L720,150 Z" fill="rgba(245, 34, 45, 0.1)"></path>
                                    
                                    <!-- 标注 -->
                                    <text x="600" y="30" text-anchor="middle" fill="#f5222d" font-weight="bold" font-size="14">户表关系变更后线损率突变为负值</text>
                                    <text x="600" y="50" text-anchor="middle" fill="#f5222d" font-size="12">由于高容量用户被错误关联导致</text>
                                    
                                    <!-- 数据点 -->
                                    <circle cx="480" cy="170" r="4" class="point" fill="#f5222d"></circle>
                                    <text x="480" y="190" text-anchor="middle" fill="#f5222d" font-size="10" font-weight="bold">-2.1%</text>
                                    
                                    <circle cx="560" cy="175" r="4" class="point" fill="#f5222d"></circle>
                                    <text x="560" y="190" text-anchor="middle" fill="#f5222d" font-size="10" font-weight="bold">-3.2%</text>
                                </svg>
                            </div>
                            <div class="chart-legend">
                                <div class="legend-item">
                                    <div class="legend-color" style="background-color: #722ed1;"></div>
                                    <span>变更前线损率</span>
                                </div>
                                <div class="legend-item">
                                    <div class="legend-color" style="background-color: #f5222d;"></div>
                                    <span>变更后线损率(负值)</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="indicator sub">
                        <div class="indicator-name">户表关系突变负损指标(分表) (SM_RELATION_SUDDEN_NEGATIVE)</div>
                        <div class="indicator-desc">分表关联台区突变导致负损程度，评估台区内近期变更关系电表的数量占比与负损的关联性</div>
                        <div class="indicator-formula">COUNT(DISTINCT MeterNo) / COUNT(DISTINCT REGION_MeterNo) WHERE DATEDIFF(FreezeDate, CHANGE_TIME) <= 3 AND REGION_LOSS_RATIO < 0</div>
                        <div class="visualization">
                            <div class="viz-title">台区变更关系分表占比与负损关系示例</div>
                            <div class="chart">
                                <svg width="100%" height="100%" viewBox="0 0 800 200" class="bar-chart">
                                    <!-- X轴 -->
                                    <line x1="50" y1="150" x2="750" y2="150" stroke="#ccc" stroke-width="1"></line>
                                    <!-- Y轴 -->
                                    <line x1="50" y1="20" x2="50" y2="150" stroke="#ccc" stroke-width="1"></line>
                                    
                                    <!-- X轴标签 -->
                                    <text x="125" y="170" text-anchor="middle" class="axis-label">台区A</text>
                                    <text x="225" y="170" text-anchor="middle" class="axis-label">台区B</text>
                                    <text x="325" y="170" text-anchor="middle" class="axis-label">台区C</text>
                                    <text x="425" y="170" text-anchor="middle" class="axis-label">台区D</text>
                                    <text x="525" y="170" text-anchor="middle" class="axis-label">台区E</text>
                                    <text x="625" y="170" text-anchor="middle" class="axis-label">台区F</text>
                                    <text x="725" y="170" text-anchor="middle" class="axis-label">台区G</text>
                                    
                                    <!-- Y轴标签 - 左侧：变更电表占比 -->
                                    <text x="40" y="150" text-anchor="end" class="axis-label">0%</text>
                                    <text x="40" y="120" text-anchor="end" class="axis-label">20%</text>
                                    <text x="40" y="90" text-anchor="end" class="axis-label">40%</text>
                                    <text x="40" y="60" text-anchor="end" class="axis-label">60%</text>
                                    <text x="40" y="30" text-anchor="end" class="axis-label">80%</text>
                                    
                                    <!-- 变更电表占比柱形图 -->
                                    <rect x="100" y="130" width="50" height="20" fill="#13c2c2"></rect>
                                    <rect x="200" y="90" width="50" height="60" fill="#13c2c2"></rect>
                                    <rect x="300" y="30" width="50" height="120" fill="#f5222d"></rect>
                                    <rect x="400" y="120" width="50" height="30" fill="#13c2c2"></rect>
                                    <rect x="500" y="60" width="50" height="90" fill="#f5222d"></rect>
                                    <rect x="600" y="110" width="50" height="40" fill="#13c2c2"></rect>
                                    <rect x="700" y="20" width="50" height="130" fill="#f5222d"></rect>
                                    
                                    <!-- 占比标签 -->
                                    <text x="125" y="125" text-anchor="middle" font-size="10">8%</text>
                                    <text x="225" y="85" text-anchor="middle" font-size="10">42%</text>
                                    <text x="325" y="25" text-anchor="middle" fill="#f5222d" font-weight="bold" font-size="10">73%</text>
                                    <text x="425" y="115" text-anchor="middle" font-size="10">15%</text>
                                    <text x="525" y="55" text-anchor="middle" fill="#f5222d" font-weight="bold" font-size="10">58%</text>
                                    <text x="625" y="105" text-anchor="middle" font-size="10">24%</text>
                                    <text x="725" y="15" text-anchor="middle" fill="#f5222d" font-weight="bold" font-size="10">82%</text>
                                    
                                    <!-- 线损率点 -->
                                    <circle cx="125" cy="140" r="4" fill="#1890ff"></circle>
                                    <circle cx="225" cy="120" r="4" fill="#1890ff"></circle>
                                    <circle cx="325" cy="170" r="5" fill="#f5222d"></circle>
                                    <circle cx="425" cy="100" r="4" fill="#1890ff"></circle>
                                    <circle cx="525" cy="165" r="5" fill="#f5222d"></circle>
                                    <circle cx="625" cy="130" r="4" fill="#1890ff"></circle>
                                    <circle cx="725" cy="175" r="5" fill="#f5222d"></circle>
                                    
                                    <!-- 线损率连线 -->
                                    <path d="M125,140 L225,120 L325,170 L425,100 L525,165 L625,130 L725,175" fill="none" stroke="#1890ff" stroke-width="1" stroke-dasharray="3,3"></path>
                                    
                                    <!-- 负损标签 -->
                                    <text x="325" y="185" text-anchor="middle" fill="#f5222d" font-size="10" font-weight="bold">-2.3%</text>
                                    <text x="525" y="185" text-anchor="middle" fill="#f5222d" font-size="10" font-weight="bold">-1.8%</text>
                                    <text x="725" y="185" text-anchor="middle" fill="#f5222d" font-size="10" font-weight="bold">-3.5%</text>
                                    
                                    <!-- 说明文字 -->
                                    <text x="400" y="40" text-anchor="middle" fill="#f5222d" font-weight="bold" font-size="14">变更电表占比高的台区出现负损</text>
                                </svg>
                            </div>
                            <div class="chart-legend">
                                <div class="legend-item">
                                    <div class="legend-color" style="background-color: #13c2c2;"></div>
                                    <span>正常台区变更占比</span>
                                </div>
                                <div class="legend-item">
                                    <div class="legend-color" style="background-color: #f5222d;"></div>
                                    <span>负损台区变更占比</span>
                                </div>
                                <div class="legend-item">
                                    <div class="legend-color" style="background-color: #1890ff;"></div>
                                    <span>台区线损率</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="indicator-group">
                    <h3>原因三：恶劣天气影响</h3>
                    <div class="indicator total">
                        <div class="indicator-name">恶劣天气突变负损指标(总表) (GM_WEATHER_SUDDEN_NEGATIVE)</div>
                        <div class="indicator-desc">总表受恶劣天气影响突变负损程度，评估恶劣天气期间线损率是否突变为负值</div>
                        <div class="indicator-formula">LOSS_RATIO - AVG(LOSS_RATIO OVER PREV_NORMAL_DAYS) WHERE WEATHER_CONDITION IN ('暴雨', '台风', '雷暴', '冰雪') AND DATEDIFF(STATIS_DATE, WEATHER_DATE) <= 1 AND LOSS_RATIO < 0</div>
                        <div class="visualization">
                            <div class="viz-title">恶劣天气期间线损率变化示例</div>
                            <div class="chart">
                                <svg width="100%" height="100%" viewBox="0 0 800 200" class="line-chart">
                                    <!-- X轴 -->
                                    <line x1="50" y1="150" x2="750" y2="150" stroke="#ccc" stroke-width="1"></line>
                                    <!-- Y轴 -->
                                    <line x1="50" y1="20" x2="50" y2="180" stroke="#ccc" stroke-width="1"></line>
                                    
                                    <!-- X轴刻度 - 日期 -->
                                    <text x="100" y="170" text-anchor="middle" class="axis-label">11/1</text>
                                    <text x="200" y="170" text-anchor="middle" class="axis-label">11/3</text>
                                    <text x="300" y="170" text-anchor="middle" class="axis-label">11/5</text>
                                    <text x="400" y="170" text-anchor="middle" class="axis-label">11/7</text>
                                    <text x="500" y="170" text-anchor="middle" class="axis-label">11/9</text>
                                    <text x="600" y="170" text-anchor="middle" class="axis-label">11/11</text>
                                    <text x="700" y="170" text-anchor="middle" class="axis-label">11/13</text>
                                    
                                    <!-- Y轴刻度 - 线损率 -->
                                    <text x="40" y="180" text-anchor="end" class="axis-label">-5%</text>
                                    <text x="40" y="150" text-anchor="end" class="axis-label">0%</text>
                                    <text x="40" y="120" text-anchor="end" class="axis-label">5%</text>
                                    <text x="40" y="90" text-anchor="end" class="axis-label">10%</text>
                                    <text x="40" y="60" text-anchor="end" class="axis-label">15%</text>
                                    
                                    <!-- 零线 -->
                                    <line x1="50" y1="150" x2="750" y2="150" stroke="#000" stroke-width="1"></line>
                                    
                                    <!-- 恶劣天气区域 -->
                                    <rect x="400" y="20" width="200" height="160" fill="rgba(250, 219, 20, 0.1)"></rect>
                                    <text x="500" y="35" text-anchor="middle" fill="#faad14" font-size="12" font-weight="bold">暴雨天气</text>
                                    
                                    <!-- 变天前线损率曲线 -->
                                    <path d="M50,120 L100,115 L150,118 L200,113 L250,116 L300,110 L350,115 L400,112" fill="none" stroke="#722ed1" stroke-width="2"></path>
                                    
                                    <!-- 变天期间线损率曲线 -->
                                    <path d="M400,112 L450,175 L500,180 L550,178 L600,176" fill="none" stroke="#f5222d" stroke-width="2"></path>
                                    
                                    <!-- 恢复后线损率曲线 -->
                                    <path d="M600,176 L650,145 L700,120 L750,115" fill="none" stroke="#1890ff" stroke-width="2"></path>
                                    
                                    <!-- 负损区域标记 -->
                                    <path d="M400,150 L450,175 L500,180 L550,178 L600,176 L600,150 Z" fill="rgba(245, 34, 45, 0.1)"></path>
                                    
                                    <!-- 数据点和标签 -->
                                    <circle cx="500" cy="180" r="5" fill="#f5222d"></circle>
                                    <text x="500" y="195" text-anchor="middle" fill="#f5222d" font-size="10" font-weight="bold">-3.8%</text>
                                    
                                    <!-- 说明文字 -->
                                    <text x="400" y="75" text-anchor="start" fill="#f5222d" font-weight="bold" font-size="14">暴雨期间线损率突变为负值</text>
                                    <text x="400" y="95" text-anchor="start" fill="#f5222d" font-size="12">暴雨可能导致计量设备或通信异常</text>
                                </svg>
                            </div>
                            <div class="chart-legend">
                                <div class="legend-item">
                                    <div class="legend-color" style="background-color: #722ed1;"></div>
                                    <span>天气正常期间线损率</span>
                                </div>
                                <div class="legend-item">
                                    <div class="legend-color" style="background-color: #f5222d;"></div>
                                    <span>恶劣天气期间线损率</span>
                                </div>
                                <div class="legend-item">
                                    <div class="legend-color" style="background-color: #1890ff;"></div>
                                    <span>天气恢复后线损率</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="indicator sub">
                        <div class="indicator-name">恶劣天气突变负损指标(分表) (SM_WEATHER_SUDDEN_NEGATIVE)</div>
                        <div class="indicator-desc">分表受恶劣天气影响突变负损程度，评估恶劣天气期间分表异常事件与负损的关联性</div>
                        <div class="indicator-formula">COUNT(Event-2001 OR Event-2002 OR Event-2003) / COUNT(DISTINCT MeterNo) WHERE WEATHER_CONDITION IN ('暴雨', '台风', '雷暴', '冰雪') AND DATEDIFF(FreezeDate, WEATHER_DATE) <= 1 AND REGION_LOSS_RATIO < 0</div>
                        <div class="visualization">
                            <div class="viz-title">恶劣天气期间分表事件统计示例</div>
                            <div class="chart">
                                <svg width="100%" height="100%" viewBox="0 0 800 200" class="bar-chart">
                                    <!-- X轴 -->
                                    <line x1="50" y1="150" x2="750" y2="150" stroke="#ccc" stroke-width="1"></line>
                                    <!-- Y轴 -->
                                    <line x1="50" y1="20" x2="50" y2="150" stroke="#ccc" stroke-width="1"></line>
                                    
                                    <!-- X轴标签 -->
                                    <text x="160" y="170" text-anchor="middle" class="axis-label">电压异常事件</text>
                                    <text x="320" y="170" text-anchor="middle" class="axis-label">信号中断事件</text>
                                    <text x="480" y="170" text-anchor="middle" class="axis-label">时钟异常事件</text>
                                    <text x="640" y="170" text-anchor="middle" class="axis-label">数据异常事件</text>
                                    
                                    <!-- Y轴标签 -->
                                    <text x="40" y="150" text-anchor="end" class="axis-label">0%</text>
                                    <text x="40" y="120" text-anchor="end" class="axis-label">20%</text>
                                    <text x="40" y="90" text-anchor="end" class="axis-label">40%</text>
                                    <text x="40" y="60" text-anchor="end" class="axis-label">60%</text>
                                    <text x="40" y="30" text-anchor="end" class="axis-label">80%</text>
                                    
                                    <!-- 恶劣天气前事件比例柱形图 -->
                                    <rect x="100" y="140" width="50" height="10" fill="#13c2c2"></rect>
                                    <rect x="260" y="135" width="50" height="15" fill="#13c2c2"></rect>
                                    <rect x="420" y="140" width="50" height="10" fill="#13c2c2"></rect>
                                    <rect x="580" y="138" width="50" height="12" fill="#13c2c2"></rect>
                                    
                                    <!-- 恶劣天气期间事件比例柱形图 -->
                                    <rect x="170" y="60" width="50" height="90" fill="#f5222d"></rect>
                                    <rect x="330" y="30" width="50" height="120" fill="#f5222d"></rect>
                                    <rect x="490" y="70" width="50" height="80" fill="#f5222d"></rect>
                                    <rect x="650" y="50" width="50" height="100" fill="#f5222d"></rect>
                                    
                                    <!-- 事件比例标签 -->
                                    <text x="125" y="135" text-anchor="middle" font-size="10">5%</text>
                                    <text x="285" y="130" text-anchor="middle" font-size="10">8%</text>
                                    <text x="445" y="135" text-anchor="middle" font-size="10">5%</text>
                                    <text x="605" y="133" text-anchor="middle" font-size="10">6%</text>
                                    
                                    <text x="195" y="55" text-anchor="middle" fill="#f5222d" font-weight="bold" font-size="10">54%</text>
                                    <text x="355" y="25" text-anchor="middle" fill="#f5222d" font-weight="bold" font-size="10">72%</text>
                                    <text x="515" y="65" text-anchor="middle" fill="#f5222d" font-weight="bold" font-size="10">48%</text>
                                    <text x="675" y="45" text-anchor="middle" fill="#f5222d" font-weight="bold" font-size="10">60%</text>
                                    
                                    <!-- 说明文字 -->
                                    <text x="400" y="40" text-anchor="middle" fill="#f5222d" font-weight="bold" font-size="14">恶劣天气期间分表异常事件大幅增加</text>
                                    <text x="400" y="60" text-anchor="middle" fill="#f5222d" font-size="12">信号中断可能导致分表数据无法正常采集</text>
                                </svg>
                            </div>
                            <div class="chart-legend">
                                <div class="legend-item">
                                    <div class="legend-color" style="background-color: #13c2c2;"></div>
                                    <span>天气正常期间事件比例</span>
                                </div>
                                <div class="legend-item">
                                    <div class="legend-color" style="background-color: #f5222d;"></div>
                                    <span>恶劣天气期间事件比例</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="indicator-group">
                    <h3>原因四：计量装置接线错误</h3>
                    <div class="indicator total">
                        <div class="indicator-name">计量装置接线突变负损指标(总表) (GM_WIRING_SUDDEN_NEGATIVE)</div>
                        <div class="indicator-desc">总表计量装置接线突变导致负损程度，评估设备维护后功率因数变化与负损的关联性</div>
                        <div class="indicator-formula">ABS(Power_Factor - PRE_MAINTENANCE_POWER_FACTOR) WHERE IsGM = 1 AND DATEDIFF(STATIS_DATE, MAINTENANCE_DATE) <= 3 AND LOSS_RATIO < 0</div>
                        <div class="visualization">
                            <div class="viz-title">总表维护前后功率因数变化示例</div>
                            <div class="chart">
                                <svg width="100%" height="100%" viewBox="0 0 800 200" class="line-chart">
                                    <!-- X轴 -->
                                    <line x1="50" y1="150" x2="750" y2="150" stroke="#ccc" stroke-width="1"></line>
                                    <!-- Y轴 -->
                                    <line x1="50" y1="20" x2="50" y2="180" stroke="#ccc" stroke-width="1"></line>
                                    
                                    <!-- X轴刻度 - 日期 -->
                                    <text x="100" y="170" text-anchor="middle" class="axis-label">11/1</text>
                                    <text x="200" y="170" text-anchor="middle" class="axis-label">11/3</text>
                                    <text x="300" y="170" text-anchor="middle" class="axis-label">11/5</text>
                                    
                                    <!-- 设备维护点 -->
                                    <line x1="400" y1="20" x2="400" y2="180" stroke="#722ed1" stroke-width="2" stroke-dasharray="5,5"></line>
                                    <text x="400" y="15" text-anchor="middle" fill="#722ed1" font-size="12" font-weight="bold">设备维护</text>
                                    
                                    <text x="500" y="170" text-anchor="middle" class="axis-label">11/8</text>
                                    <text x="600" y="170" text-anchor="middle" class="axis-label">11/10</text>
                                    <text x="700" y="170" text-anchor="middle" class="axis-label">11/12</text>
                                    
                                    <!-- Y轴左侧刻度 - 功率因数 -->
                                    <text x="40" y="150" text-anchor="end" class="axis-label">-1.0</text>
                                    <text x="40" y="120" text-anchor="end" class="axis-label">-0.5</text>
                                    <text x="40" y="90" text-anchor="end" class="axis-label">0.0</text>
                                    <text x="40" y="60" text-anchor="end" class="axis-label">0.5</text>
                                    <text x="40" y="30" text-anchor="end" class="axis-label">1.0</text>
                                    
                                    <!-- 零线 -->
                                    <line x1="50" y1="90" x2="750" y2="90" stroke="#000" stroke-width="1"></line>
                                    
                                    <!-- 维护前功率因数曲线 -->
                                    <path d="M50,60 L100,58 L200,62 L300,60 L400,55" fill="none" stroke="#722ed1" stroke-width="2"></path>
                                    
                                    <!-- 维护后功率因数曲线（反相） -->
                                    <path d="M400,55 L500,120 L600,125 L700,122" fill="none" stroke="#f5222d" stroke-width="2"></path>
                                    
                                    <!-- 线损率点 -->
                                    <circle cx="100" cy="120" r="3" fill="#1890ff"></circle>
                                    <circle cx="200" cy="125" r="3" fill="#1890ff"></circle>
                                    <circle cx="300" cy="115" r="3" fill="#1890ff"></circle>
                                    <circle cx="400" cy="120" r="3" fill="#1890ff"></circle>
                                    <circle cx="500" cy="160" r="4" fill="#f5222d"></circle>
                                    <circle cx="600" cy="165" r="4" fill="#f5222d"></circle>
                                    <circle cx="700" cy="162" r="4" fill="#f5222d"></circle>
                                    
                                    <!-- 线损率线 -->
                                    <path d="M100,120 L200,125 L300,115 L400,120 L500,160 L600,165 L700,162" fill="none" stroke="#1890ff" stroke-width="1" stroke-dasharray="3,3"></path>
                                    
                                    <!-- 维护后负损区域标记 -->
                                    <path d="M400,150 L500,160 L600,165 L700,162 L700,150 Z" fill="rgba(245, 34, 45, 0.1)"></path>
                                    
                                    <!-- 说明文字 -->
                                    <text x="600" y="35" text-anchor="middle" fill="#f5222d" font-weight="bold" font-size="14">CT接线反极性安装导致功率因数反向</text>
                                    <text x="600" y="55" text-anchor="middle" fill="#f5222d" font-size="12">同时线损率突变为负值</text>
                                    
                                    <!-- 负损标签 -->
                                    <text x="500" y="175" text-anchor="middle" fill="#f5222d" font-size="10" font-weight="bold">-2.1%</text>
                                    <text x="600" y="180" text-anchor="middle" fill="#f5222d" font-size="10" font-weight="bold">-3.8%</text>
                                </svg>
                            </div>
                            <div class="chart-legend">
                                <div class="legend-item">
                                    <div class="legend-color" style="background-color: #722ed1;"></div>
                                    <span>维护前功率因数</span>
                                </div>
                                <div class="legend-item">
                                    <div class="legend-color" style="background-color: #f5222d;"></div>
                                    <span>维护后功率因数(反向)</span>
                                </div>
                                <div class="legend-item">
                                    <div class="legend-color" style="background-color: #1890ff;"></div>
                                    <span>线损率变化</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="indicator sub">
                        <div class="indicator-name">计量装置接线突变负损指标(分表) (SM_WIRING_SUDDEN_NEGATIVE)</div>
                        <div class="indicator-desc">分表计量装置接线突变导致负损程度，评估近期维护的分表异常事件占比与负损的关联性</div>
                        <div class="indicator-formula">COUNT(Event-1025 OR Event-1026 OR Event-1027) / COUNT(DISTINCT MeterNo WHERE MAINTENANCE_TYPE IS NOT NULL) WHERE IsGM = 0 AND DATEDIFF(FreezeDate, MAINTENANCE_DATE) <= 3 AND REGION_LOSS_RATIO < 0</div>
                        <div class="visualization">
                            <div class="viz-title">分表维护后接线异常事件占比示例</div>
                            <div class="chart">
                                <svg width="100%" height="100%" viewBox="0 0 800 200" class="heatmap-chart">
                                    <!-- 背景框 -->
                                    <rect x="50" y="20" width="700" height="130" fill="#f9f9f9" stroke="#ccc" stroke-width="1"></rect>
                                    
                                    <!-- X轴标签 - 台区 -->
                                    <text x="125" y="170" text-anchor="middle" class="axis-label">台区A</text>
                                    <text x="225" y="170" text-anchor="middle" class="axis-label">台区B</text>
                                    <text x="325" y="170" text-anchor="middle" class="axis-label">台区C</text>
                                    <text x="425" y="170" text-anchor="middle" class="axis-label">台区D</text>
                                    <text x="525" y="170" text-anchor="middle" class="axis-label">台区E</text>
                                    <text x="625" y="170" text-anchor="middle" class="axis-label">台区F</text>
                                    <text x="725" y="170" text-anchor="middle" class="axis-label">台区G</text>
                                    
                                    <!-- Y轴标签 - 异常类型 -->
                                    <text x="40" y="40" text-anchor="end" class="axis-label">相序异常</text>
                                    <text x="40" y="70" text-anchor="end" class="axis-label">反极性接线</text>
                                    <text x="40" y="100" text-anchor="end" class="axis-label">接线错误</text>
                                    <text x="40" y="130" text-anchor="end" class="axis-label">线损率</text>
                                    
                                    <!-- 热力图单元格 - 相序异常 -->
                                    <rect class="cell" x="75" y="25" width="50" height="30" fill="#e6f7ff"></rect>
                                    <rect class="cell" x="175" y="25" width="50" height="30" fill="#e6f7ff"></rect>
                                    <rect class="cell" x="275" y="25" width="50" height="30" fill="#ffa39e"></rect>
                                    <rect class="cell" x="375" y="25" width="50" height="30" fill="#e6f7ff"></rect>
                                    <rect class="cell" x="475" y="25" width="50" height="30" fill="#ff7875"></rect>
                                    <rect class="cell" x="575" y="25" width="50" height="30" fill="#e6f7ff"></rect>
                                    <rect class="cell" x="675" y="25" width="50" height="30" fill="#a8071a"></rect>
                                    
                                    <!-- 热力图单元格 - 反极性接线 -->
                                    <rect class="cell" x="75" y="55" width="50" height="30" fill="#e6f7ff"></rect>
                                    <rect class="cell" x="175" y="55" width="50" height="30" fill="#bae7ff"></rect>
                                    <rect class="cell" x="275" y="55" width="50" height="30" fill="#cf1322"></rect>
                                    <rect class="cell" x="375" y="55" width="50" height="30" fill="#e6f7ff"></rect>
                                    <rect class="cell" x="475" y="55" width="50" height="30" fill="#f5222d"></rect>
                                    <rect class="cell" x="575" y="55" width="50" height="30" fill="#e6f7ff"></rect>
                                    <rect class="cell" x="675" y="55" width="50" height="30" fill="#a8071a"></rect>
                                    
                                    <!-- 热力图单元格 - 接线错误 -->
                                    <rect class="cell" x="75" y="85" width="50" height="30" fill="#e6f7ff"></rect>
                                    <rect class="cell" x="175" y="85" width="50" height="30" fill="#e6f7ff"></rect>
                                    <rect class="cell" x="275" y="85" width="50" height="30" fill="#ff7875"></rect>
                                    <rect class="cell" x="375" y="85" width="50" height="30" fill="#bae7ff"></rect>
                                    <rect class="cell" x="475" y="85" width="50" height="30" fill="#ff4d4f"></rect>
                                    <rect class="cell" x="575" y="85" width="50" height="30" fill="#e6f7ff"></rect>
                                    <rect class="cell" x="675" y="85" width="50" height="30" fill="#cf1322"></rect>
                                    
                                    <!-- 线损率条形 -->
                                    <rect x="75" y="115" width="50" height="30" fill="#91d5ff"></rect>
                                    <rect x="175" y="115" width="50" height="30" fill="#91d5ff"></rect>
                                    <rect x="275" y="115" width="50" height="30" fill="#f5222d"></rect>
                                    <rect x="375" y="115" width="50" height="30" fill="#91d5ff"></rect>
                                    <rect x="475" y="115" width="50" height="30" fill="#f5222d"></rect>
                                    <rect x="575" y="115" width="50" height="30" fill="#91d5ff"></rect>
                                    <rect x="675" y="115" width="50" height="30" fill="#f5222d"></rect>
                                    
                                    <!-- 负损台区标签 -->
                                    <text x="300" y="130" class="cell-label">-2.9%</text>
                                    <text x="500" y="130" class="cell-label">-3.1%</text>
                                    <text x="700" y="130" class="cell-label">-4.7%</text>
                                    
                                    <!-- 异常事件占比标签 -->
                                    <text x="300" y="40" class="cell-label">42%</text>
                                    <text x="500" y="40" class="cell-label">58%</text>
                                    <text x="700" y="40" class="cell-label">75%</text>
                                    
                                    <text x="300" y="70" class="cell-label">65%</text>
                                    <text x="500" y="70" class="cell-label">62%</text>
                                    <text x="700" y="70" class="cell-label">78%</text>
                                    
                                    <text x="300" y="100" class="cell-label">53%</text>
                                    <text x="500" y="100" class="cell-label">60%</text>
                                    <text x="700" y="100" class="cell-label">68%</text>
                                    
                                    <!-- 说明文字 -->
                                    <text x="400" y="40" text-anchor="middle" fill="#f5222d" font-weight="bold" font-size="14">维护后接线异常事件占比高的台区出现负损</text>
                                </svg>
                            </div>
                            <div class="chart-legend">
                                <div class="legend-item">
                                    <div class="legend-color" style="background-color: #e6f7ff;"></div>
                                    <span>正常(0-10%)</span>
                                </div>
                                <div class="legend-item">
                                    <div class="legend-color" style="background-color: #bae7ff;"></div>
                                    <span>偶发(10-30%)</span>
                                </div>
                                <div class="legend-item">
                                    <div class="legend-color" style="background-color: #ffa39e;"></div>
                                    <span>频繁(30-50%)</span>
                                </div>
                                <div class="legend-item">
                                    <div class="legend-color" style="background-color: #f5222d;"></div>
                                    <span>异常(50-70%)</span>
                                </div>
                                <div class="legend-item">
                                    <div class="legend-color" style="background-color: #a8071a;"></div>
                                    <span>严重(>70%)</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
</html> 